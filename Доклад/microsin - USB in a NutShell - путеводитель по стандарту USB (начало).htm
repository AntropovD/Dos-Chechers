<!--?xml version="1.0"?-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
  <title>microsin - USB in a NutShell - путеводитель по стандарту USB (начало)</title>
<meta name="description" content="Начало перевода на русский язык &quot;USB in a NutShell&quot;">
<meta name="keywords" content="USB, HID, host, VID, PID, Control, Interrupt, Bulk, Isochronous, VBUS, endpoint, descriptor, interface, PIC16F876, PDIUSBD11">
<meta name="Generator" content="Joomla! - Авторские права (C) 2005-2007 OSM. Все права защищены.">
<meta name="robots" content="index, follow">
<link href="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/style.css" rel="stylesheet" type="text/css">
<script language="JavaScript" type="text/javascript" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/proofreader.js"></script>
<script language="JavaScript" type="text/javascript" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/xajax.js"></script>
<script language="JavaScript" type="text/javascript"><!-- // --><![CDATA[
	function pr_setup() {
		xajaxRequestUri='http://microsin.ru/index2.php?option=com_proofreader&task=sendmistake&no_html=1';
		xajaxWaitCursor=true;
		xajaxDefinedPost=1;
		xajaxDebug=false;
		xajaxStatusMessages=false;
		xajaxDefinedGet=0;
	}

	function addEvent(element, eventType, functionName) {
		if (element.addEventListener) {
			element.addEventListener(eventType, functionName, false);
			return true;
		} else if (element.attachEvent) {
			var r = element.attachEvent('on' + eventType, functionName);
			return r;
		} else {
			element['on' + eventType] = functionName;
		}
	}

	function addDivWindow() {
		var x=document.createElement("div");
		x.id='MistWindow';
		x.style.position='absolute';
		x.style.display='none';
		x.style.width='375px';
		x.style.height='380px';
		x.style.top='50px';
		x.style.left='50px';
		x.style.zIndex=2;
		document.body.appendChild(x);
	}


var xajaxRequestUri='http://microsin.ru/index2.php?option=com_proofreader&task=sendmistake&no_html=1';
var xajaxWaitCursor=true;
var xajaxDefinedPost=1;
var xajaxDebug=false;
var xajaxStatusMessages=false;
var xajaxDefinedGet=0;
var PReader_cur_page = "http://microsin.ru/index.php?option=com_content&task=view&id=1107&Itemid=44"; var pr_alt = false;  var pr_shift = true;  var pr_ctrl = false; 
addEvent(window, 'load',  addDivWindow);
addEvent(window, 'load',  keyPressInit);
// ]]></script>
<link rel="alternate" type="application/rss+xml" title="USB in a NutShell - путеводитель по стандарту USB (начало)" href="http://microsin.ru/index2.php?option=com_jcomments&amp;task=rss&amp;object_id=1107&amp;object_group=com_content&amp;no_html=1">
<!-- base href="http://microsin.ru/" -->
	<link rel="shortcut icon" href="http://microsin.ru/favicon.ico">
	  <link href="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/template_css.css" rel="stylesheet" type="text/css">
  <!-- <link rel="shortcut icon" href="http://microsin.ru/images/favicon.ico" /> -->
  <link rel="shortcut gif" href="http://microsin.ru/images/favicon16x16-8b.gif">
<style id="ya_share_style" type="text/css">.b-share-popup-wrap{z-index:1073741823;position:absolute;width:500px}.b-share-popup{position:absolute;z-index:1073741823;border:1px solid #888;background:#FFF;color:#000}.b-share-popup-wrap .b-share-popup_down{top:0}.b-share-popup-wrap .b-share-popup_up{bottom:0}.b-share-popup-wrap_state_hidden{position:absolute!important;top:-9999px!important;right:auto!important;bottom:auto!important;left:-9999px!important;visibility:hidden!important}.b-share-popup,x:nth-child(1){border:0;padding:1px!important}@media all and (resolution=0){.b-share-popup,x:nth-child(1),x:-o-prefocus{padding:0!important;border:1px solid #888}}.b-share-popup__i{display:-moz-inline-box;display:inline-block;padding:5px 0!important;overflow:hidden;vertical-align:top;white-space:nowrap;visibility:visible;background:#FFF;-webkit-box-shadow:0 2px 9px rgba(0,0,0,.6);-moz-box-shadow:0 2px 9px rgba(0,0,0,.6);box-shadow:0 2px 9px rgba(0,0,0,.6)}.b-share-popup__item{font:1em/1.25em Arial,sans-serif;display:block;padding:5px 15px!important;white-space:nowrap;background:#FFF}.b-share-popup__item,a.b-share-popup__item:link,a.b-share-popup__item:visited{text-decoration:none!important;border:0!important}a.b-share-popup__item{cursor:pointer}a.b-share-popup__item .b-share-popup__item__text{display:inline;text-decoration:underline;color:#1A3DC1}a.b-share-popup__item:hover{word-spacing:0}a.b-share-popup__item:hover .b-share-popup__item__text{color:red;cursor:pointer}.b-share-popup__icon{display:-moz-inline-box;display:inline-block;margin:-3px 0 0;padding:0 5px 0 0!important;vertical-align:middle}.b-share-popup__icon_input{width:21px;height:16px;margin-top:-6px;padding:0!important}.b-share-popup__icon__input{margin-right:0;margin-left:2px;vertical-align:top}.b-share-popup__spacer{display:block;padding-top:10px!important}.b-share-popup__header{font:86%/1em Verdana,sans-serif;display:block;padding:10px 15px 5px!important;color:#999}.b-share-popup__header_first{padding-top:5px!important}.b-share-popup__input{font:86%/1em Verdana,sans-serif;display:block;padding:5px 15px!important;color:#999;text-align:left}.b-share-popup__input__input{font:1em/1em Verdana,sans-serif;display:block;width:10px;margin:5px 0 0;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;resize:none;text-align:left;direction:ltr}.b-share-popup_down .b-share-popup_with-link .b-share-popup__input_link{position:absolute;top:5px;right:0;left:0}.b-share-popup_up .b-share-popup_with-link .b-share-popup__input_link{position:absolute;right:0;bottom:5px;left:0}.b-share-popup_down .b-share-popup_with-link{padding-top:55px!important}.b-share-popup_up .b-share-popup_with-link{padding-bottom:55px!important}.b-share-popup_down .b-share-popup_expandable .b-share-popup__main{padding-bottom:25px!important}.b-share-popup_up .b-share-popup_expandable .b-share-popup__main{padding-top:25px!important}.b-share-popup_down .b-share-popup_yandexed{padding-bottom:10px!important}.b-share-popup_up .b-share-popup_yandexed{padding-top:10px!important}.b-share-popup__yandex{position:absolute;right:4px;bottom:2px;font:78.125%/1em Verdana,sans-serif;padding:3px!important;background:0 0}a.b-share-popup__yandex:link,a.b-share-popup__yandex:visited{color:#C6C5C5;text-decoration:none}a.b-share-popup__yandex:link:hover,a.b-share-popup__yandex:visited:hover{color:red;text-decoration:underline}.b-share-popup_up .b-share-popup__yandex{top:2px;bottom:auto}.b-share-popup_expandable .b-share-popup__yandex{right:auto;left:4px}.b-share-popup_to-right .b-share-popup_expandable .b-share-popup__yandex{right:4px;left:auto}.b-share-popup__expander .b-share-popup__item{position:absolute;bottom:5px;font:86%/1em Verdana,sans-serif;margin:10px 0 0;padding:5px 10px!important;cursor:pointer;color:#999;background:0 0}.b-share-popup_to-right,.b-share-popup_to-right .b-share-popup__expander{direction:rtl}.b-share-popup_to-right .b-share-popup__expander .b-share-popup__icon{padding:0 0 0 5px!important}.b-share-popup_up .b-share-popup__expander .b-share-popup__item{top:-5px;bottom:auto}.b-share-popup__expander .b-share-popup__item:hover .b-share-popup__item__text{text-decoration:underline}.b-share-popup__expander .b-ico_action_rarr,.b-share-popup_to-right .b-share-popup__expander .b-ico_action_larr,.b-share-popup_full .b-share-popup__expander .b-ico_action_larr,.b-share-popup_to-right .b-share-popup_full .b-share-popup__expander .b-ico_action_rarr,.b-share-popup__expander .b-share-popup__item__text_collapse,.b-share-popup_full .b-share-popup__item__text_expand{display:none}.b-share-popup_to-right .b-share-popup__expander .b-ico_action_rarr,.b-share-popup_full .b-share-popup__item__text_collapse,.b-share-popup_full .b-share-popup__expander .b-ico_action_rarr,.b-share-popup_to-right .b-share-popup_full .b-share-popup__expander .b-ico_action_larr{display:inline}.b-ico_action_rarr,.b-ico_action_larr{width:8px;height:7px;border:0}.b-share-popup__main,.b-share-popup__extra{direction:ltr;vertical-align:bottom;text-align:left}.b-share-popup_down .b-share-popup__main,.b-share-popup_down .b-share-popup__extra{vertical-align:top}.b-share-popup__main{display:-moz-inline-stack;display:inline-block}.b-share-popup__extra{display:none;margin:0 -10px 0 0}.b-share-popup_full .b-share-popup__extra{display:-moz-inline-stack;display:inline-block}.b-share-popup_to-right .b-share-popup__extra{margin:0 0 0 -10px}.b-share-popup__tail{position:absolute;width:21px;height:10px;margin:0 0 0 -11px}.b-share-popup_down .b-share-popup__tail{top:-10px;background:url("//yastatic.net/share/static/b-share-popup_down__tail.gif") 0 0 no-repeat}.b-share-popup_up .b-share-popup__tail{bottom:-10px;background:url("//yastatic.net/share/static/b-share-popup_up__tail.gif") 0 0 no-repeat}.b-share-popup_down .b-share-popup__tail,x:nth-child(1){top:-9px;background-image:url("//yastatic.net/share/static/b-share-popup_down__tail.png")}.b-share-popup_up .b-share-popup__tail,x:nth-child(1){bottom:-9px;background-image:url("//yastatic.net/share/static/b-share-popup_up__tail.png")}@media all and (resolution=0){.b-share-popup_down .b-share-popup__tail,x:nth-child(1),x:-o-prefocus{top:-10px;background-image:url("//yastatic.net/share/static/b-share-popup_down__tail.gif")}.b-share-popup_up .b-share-popup__tail,x:nth-child(1),x:-o-prefocus{bottom:-10px;background-image:url("//yastatic.net/share/static/b-share-popup_up__tail.gif")}}.b-share-popup .b-share-popup_show_form_mail,.b-share-popup .b-share-popup_show_form_html{padding:0!important}.b-share-popup .b-share-popup_show_form_mail .b-share-popup__main,.b-share-popup .b-share-popup_show_form_html .b-share-popup__main,.b-share-popup .b-share-popup_show_form .b-share-popup__main,.b-share-popup .b-share-popup_show_form_mail .b-share-popup__extra,.b-share-popup .b-share-popup_show_form_html .b-share-popup__extra,.b-share-popup .b-share-popup_show_form .b-share-popup__extra{height:15px;padding:0!important;overflow:hidden;visibility:hidden}.b-share-popup_show_form_mail .b-share-popup__expander,.b-share-popup_show_form_html .b-share-popup__expander,.b-share-popup_show_form .b-share-popup__expander,.b-share-popup_show_form_mail .b-share-popup__input_link,.b-share-popup_show_form_html .b-share-popup__input_link,.b-share-popup_show_form .b-share-popup__input_link{display:none}.b-share-popup__form{position:relative;display:none;overflow:hidden;padding:5px 0 0!important;margin:0 0 -15px;white-space:normal}.b-share-popup_show_form_mail .b-share-popup__form_mail,.b-share-popup_show_form_html .b-share-popup__form_html,.b-share-popup_show_form .b-share-popup__form{display:block}.b-share-popup__form__link{padding:5px!important;margin:0 0 5px 10px;text-decoration:underline;cursor:pointer;color:#1A3DC1}.b-share-popup__form__link,.b-share-popup__form__button{font:86%/1.4545em Verdana,sans-serif;float:left;display:inline}.b-share-popup__form__button{margin:5px 0 0 15px}.b-share-popup__form__close{font:86%/1.4545em Verdana,sans-serif;float:right;display:inline;padding:5px!important;margin:0 10px 5px 0;cursor:pointer;color:#999}a.b-share-popup__form__link:hover,a.b-share-popup__form__close:hover{text-decoration:underline;color:red}.b-share-popup_font_fixed .b-share-popup__item{font-size:12.8px}.b-share-popup_font_fixed .b-share-popup__header,.b-share-popup_font_fixed .b-share-popup__input,.b-share-popup_font_fixed .b-share-popup__expander .b-share-popup__item,.b-share-popup_font_fixed .b-share-popup__form__link,.b-share-popup_font_fixed .b-share-popup__form__button,.b-share-popup_font_fixed .b-share-popup__form__close{font-size:11px}.b-share-popup_font_fixed .b-share-popup__yandex{font-size:10px}.b-share-form-button{font:86%/17px Verdana,Arial,sans-serif;display:-moz-inline-box;display:inline-block;position:relative;height:19px;margin:0 3px;padding:0 4px;cursor:default;white-space:nowrap;text-decoration:none!important;color:#000!important;border:none;outline:none;background:url("//yastatic.net/share/static/b-share-form-button.png") 0 -20px repeat-x}.b-share-form-button:link:hover,.b-share-form-button:visited:hover{color:#000!important}.b-share-form-button__before,.b-share-form-button__after{position:absolute;width:3px;height:19px;background:url("//yastatic.net/share/static/b-share-form-button.png")}.b-share-form-button__before{margin-left:-7px}.b-share-form-button__after{margin-left:4px;background-position:-3px 0}.b-share-form-button::-moz-focus-inner{border:none}button.b-share-form-button .b-share-form-button__before,button.b-share-form-button .b-share-form-button__after{margin-top:-1px}@-moz-document url-prefix(){button.b-share-form-button .b-share-form-button__after{margin-top:-2px;margin-left:6px}button.b-share-form-button .b-share-form-button__before{margin-top:-2px;margin-left:-9px}}SPAN.b-share-form-button:hover,.b-share-form-button_state_hover{background-position:0 -60px}SPAN.b-share-form-button:hover .b-share-form-button__before,.b-share-form-button_state_hover .b-share-form-button__before{background-position:0 -40px}SPAN.b-share-form-button:hover .b-share-form-button__after,.b-share-form-button_state_hover .b-share-form-button__after{background-position:-3px -40px}.b-share-form-button_state_pressed,.b-share-form-button_state_pressed .b-share-form-button_share{background-position:0 -100px!important}.b-share-form-button_state_pressed .b-share-form-button__before{background-position:0 -80px!important}.b-share-form-button_state_pressed .b-share-form-button__after{background-position:-3px -80px!important}button.b-share-form-button_state_pressed{overflow:visible}.b-share-form-button_icons{position:relative;padding:0;background-position:0 -20px!important}.b-share-form-button_icons .b-share-form-button__before{left:0;margin-left:-3px;background-position:0 0!important}.b-share-form-button_icons .b-share-form-button__after{z-index:-1;margin-left:0;background-position:-3px 0!important}.b-share-form-button_icons .b-share__handle{padding:2px!important}.b-share-form-button_icons .b-share__handle_more{position:relative;padding-right:6px!important;margin-right:-4px}.b-share-form-button_icons .b-share-icon{opacity:.5;background-image:url("//yastatic.net/share/static/b-share-icon_size_14.png")}.b-share-form-button_icons A.b-share__handle:hover .b-share-icon{opacity:1}.b-share{font:86%/1.4545em Arial,sans-serif;display:-moz-inline-box;display:inline-block;padding:1px 3px 1px 4px!important;vertical-align:middle}.b-share .b-share-form-button{font-size:1em}.b-share__text .b-share-icon{margin:0 5px 0 0;border:none}.b-share__text{margin-right:5px}.b-share__handle{float:left;height:16px;padding:5px 3px 5px 2px!important;cursor:pointer;text-align:left;text-decoration:none!important}.b-share__handle_cursor_default{cursor:default}.b-share__handle .b-share-form-button{margin-top:-2px}.b-share__hr{display:none;float:left;width:1px;height:26px;margin:0 3px 0 2px}a.b-share__handle:hover .b-share__text{text-decoration:underline;color:red}.b-share_bordered{padding:0 2px 0 3px!important;border:1px solid #E4E4E4;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px}.b-share_bordered .b-share__hr{display:inline;background:#E4E4E4}.b-share_link{margin:-8px 0}a.b-share_link{margin:0}.b-share_link .b-share__text{text-decoration:underline;color:#1A3DC1}.b-share-form-button_share{padding-left:26px!important;vertical-align:top}.b-share-form-button_share .b-share-form-button__before{margin-left:-29px}.b-share-form-button_share .b-share-form-button__icon{position:absolute;width:20px;height:17px;margin:1px 0 0 -23px;background:url("//yastatic.net/share/static/b-share-form-button_share__icon.png") 0 0 no-repeat}.b-share-pseudo-link{border-bottom:1px dotted;cursor:pointer;text-decoration:none!important}.b-share_font_fixed{font-size:11px}.b-share__handle_more{font-size:9px;margin-top:-1px;color:#7B7B7B}A.b-share__handle_more:hover{color:#000}.b-share__group{float:left}.b-share-icon{float:left;display:inline;overflow:hidden;width:16px;height:16px;padding:0!important;vertical-align:top;border:0;background:url("//yastatic.net/share/static/b-share-icon.png") 0 99px no-repeat}.b-share-icon_vkontakte,.b-share-icon_custom{background-position:0 0}.b-share-icon_yaru,.b-share-icon_yaru_photo,.b-share-icon_yaru_wishlist{background-position:0 -17px}.b-share-icon_lj{background-position:0 -34px}.b-share-icon_twitter{background-position:0 -51px}.b-share-icon_facebook{background-position:0 -68px}.b-share-icon_moimir{background-position:0 -85px}.b-share-icon_friendfeed{background-position:0 -102px}.b-share-icon_mail{background-position:0 -119px}.b-share-icon_html{background-position:0 -136px}.b-share-icon_postcard{background-position:0 -153px}.b-share-icon_odnoklassniki{background-position:0 -170px}.b-share-icon_blogger{background-position:0 -187px}.b-share-icon_delicious{background-position:0 -221px}.b-share-icon_gbuzz{background-position:0 -238px}.b-share-icon_linkedin{background-position:0 -255px}.b-share-icon_myspace{background-position:0 -272px}.b-share-icon_evernote{background-position:0 -289px}.b-share-icon_digg{background-position:0 -306px}.b-share-icon_juick{background-position:0 -324px}.b-share-icon_moikrug{background-position:0 -341px}.b-share-icon_yazakladki{background-position:0 -358px}.b-share-icon_liveinternet{background-position:0 -375px}.b-share-icon_tutby{background-position:0 -392px}.b-share-icon_diary{background-position:0 -409px}.b-share-icon_gplus{background-position:0 -426px}.b-share-icon_pocket{background-position:0 -443px}.b-share-icon_surfingbird{background-position:0 -460px}.b-share-icon_pinterest{background-position:0 -477px}.b-share-icon_renren{background-position:0 0}.b-share-icon_renren,.b-share-icon_sina_weibo{background:url("//yastatic.net/share/static/b-share-icon__china.png") no-repeat}.b-share-icon_sina_weibo{background-position:-18px 0}.b-share-icon_qzone{background-position:-36px 0}.b-share-icon_qzone,.b-share-icon_tencent_weibo{background:url("//yastatic.net/share/static/b-share-icon__china.png") no-repeat}.b-share-icon_tencent_weibo{background-position:-54px 0}.b-share_theme_dark .b-share-icon{background:url("//yastatic.net/share/static/b-share-icons__theme_dark.png") 99px 0 no-repeat}.b-share_theme_dark .b-share-icon_odnoklassniki{background-position:-4px -3px}.b-share_theme_dark .b-share-icon_vkontakte{background-position:-24px -3px}.b-share_theme_dark .b-share-icon_twitter{background-position:-44px -3px}.b-share_theme_dark .b-share-icon_facebook{background-position:-64px -3px}.b-share_theme_dark .b-share-icon_lj{background-position:-85px -3px}.b-share_theme_dark .b-share-icon_yaru{background-position:-105px -3px}.b-share_theme_dark .b-share-popup .b-share-icon_odnoklassniki,.b-share_theme_dark .b-share-icon_odnoklassniki:hover{background-position:-4px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_vkontakte,.b-share_theme_dark .b-share-icon_vkontakte:hover{background-position:-24px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_twitter,.b-share_theme_dark .b-share-icon_twitter:hover{background-position:-44px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_facebook,.b-share_theme_dark .b-share-icon_facebook:hover{background-position:-64px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_lj,.b-share_theme_dark .b-share-icon_lj:hover{background-position:-85px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_yaru,.b-share_theme_dark .b-share-icon_yaru:hover{background-position:-105px -28px}.b-share_theme_dark .b-share-form-button_share .b-share-form-button__icon{background-image:url("//yastatic.net/share/static/b-share-form-button_share__icon_dark.png")}.b-share_theme_dark .b-share-form-button{color:#fff!important;opacity:.8}.b-share_theme_dark .b-share__handle:hover .b-share-form-button,.b-share_theme_dark .b-share-form-button:hover{opacity:1;cursor:pointer}.b-share_theme_dark .b-share-form-button,.b-share_theme_dark .b-share-form-button__before,.b-share_theme_dark .b-share-form-button__after{background:0 0}.b-share_theme_dark .b-share-popup__i{background-color:#333;border-radius:10px;-webkit-box-shadow:0 2px 9px rgba(255,255,255,.6);-moz-box-shadow:0 2px 9px rgba(255,255,255,.6);box-shadow:0 2px 9px rgba(255,255,255,.6)}.b-share_theme_dark .b-share__text{color:#AAA}.b-share_theme_dark .b-share-popup{color:#AAA;border-radius:10px;background-color:#333;background-color:rgba(50,50,50,.3)}.b-share_theme_dark .b-share-popup__item{background:0 0;color:#ccc}.b-share_theme_dark .b-share-popup .b-share-popup__item__text{color:#ccc}.b-share_theme_counter .b-share{display:inline-block;vertical-align:middle;white-space:nowrap}.b-share-counter{font:14px Arial,sans-serif;line-height:18px;display:none;float:left;margin:3px 6px 3px 3px;color:#fff}.b-share_theme_counter .b-share_type_small .b-share-counter{font-size:11px;line-height:14px;margin:2px 6px 2px 1px}.b-share_theme_counter .b-share-btn__counter .b-share-counter{display:block}.b-share-btn__counter{text-decoration:none}.b-share_theme_counter .b-share-btn__wrap{position:relative;float:left;margin-left:5px}.b-share_theme_counter .b-share_type_small .b-share-btn__wrap{margin-left:4px}.b-share_theme_counter .b-share-btn__wrap:first-child{margin-left:0}.b-share_theme_counter .b-share__link{display:inline-block;cursor:pointer;-webkit-border-radius:3px;border-radius:3px}.b-share_theme_counter .b-share_type_small .b-share__link{-webkit-border-radius:2px;border-radius:2px}.b-share_theme_counter .b-share-icon{display:block;float:left;width:24px;height:24px;background-image:url("//yastatic.net/share/static/b-share_counter_large.png");background-position:-20px 0}.b-share_theme_counter .b-share_type_small .b-share-icon{width:18px;height:18px;background-image:url("//yastatic.net/share/static/b-share_counter_small.png")}.b-share_theme_counter .b-share-icon_facebook{background-position:0 0}.b-share_theme_counter .b-share-btn__facebook{background-color:#3c5a98}.b-share_theme_counter .b-share-btn__facebook:hover{background-color:#30487a}.b-share_theme_counter .b-share-btn__facebook:active{border-top:2px solid #24365a;background-color:#334d81}.b-share_theme_counter .b-share-icon_moimir{background-position:0 -29px}.b-share_theme_counter .b-share-btn__moimir{background-color:#226eb7}.b-share_theme_counter .b-share-btn__moimir:hover{background-color:#1b5892}.b-share_theme_counter .b-share-btn__moimir:active{border-top:2px solid #14426d;background-color:#1d5e9c}.b-share_theme_counter .b-share-icon_vkontakte{background-position:0 -58px}.b-share_theme_counter .b-share-btn__vkontakte{background-color:#48729e}.b-share_theme_counter .b-share-btn__vkontakte:hover{background-color:#3a5b7e}.b-share_theme_counter .b-share-btn__vkontakte:active{border-top:2px solid #2b445e;background-color:#3d6186}.b-share_theme_counter .b-share-icon_twitter{background-position:0 -87px}.b-share_theme_counter .b-share-btn__twitter{background-color:#00aced}.b-share_theme_counter .b-share-btn__twitter:hover{background-color:#008abe}.b-share_theme_counter .b-share-btn__twitter:active{border-top:2px solid #00668d;background-color:#0092ca}.b-share_theme_counter .b-share-icon_odnoklassniki{background-position:0 -116px}.b-share_theme_counter .b-share-btn__odnoklassniki{background-color:#ff9f4d}.b-share_theme_counter .b-share-btn__odnoklassniki:hover{background-color:#cc7f3e}.b-share_theme_counter .b-share-btn__odnoklassniki:active{border-top:2px solid #975e2e;background-color:#d98742}.b-share_theme_counter .b-share-icon_gplus{background-position:0 -145px}.b-share_theme_counter .b-share-btn__gplus{background-color:#c25234}.b-share_theme_counter .b-share-btn__gplus:hover{background-color:#9b422a}.b-share_theme_counter .b-share-btn__gplus:active{border-top:2px solid #73311f;background-color:#a5462c}.b-share_theme_counter .b-share-icon_yaru{background-position:0 -174px}.b-share_theme_counter .b-share-btn__yaru{background-color:#d83933}.b-share_theme_counter .b-share-btn__yaru:hover{background-color:#ad2e29}.b-share_theme_counter .b-share-btn__yaru:active{border-top:2px solid #80221e;background-color:#b8312b}.b-share_theme_counter .b-share-icon_pinterest{background-position:0 -203px}.b-share_theme_counter .b-share-btn__pinterest{background-color:#cd1e27}.b-share_theme_counter .b-share-btn__pinterest:hover{background-color:#a4181f}.b-share_theme_counter .b-share-btn__pinterest:active{border-top:2px solid #7b1217;background-color:#ae1921}.b-share_theme_counter .b-share__link:active{height:22px}.b-share_theme_counter .b-share_type_small .b-share__link:active{height:16px}.b-share_theme_counter .b-share__link:active .b-share-icon,.b-share_theme_counter .b-share__link:active .b-share-counter{position:relative;top:-1px}.b-share_theme_counter .b-share__link::after{position:absolute;top:0;right:0;bottom:0;left:0;content:"";background-image:url(data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==)}.b-share_theme_counter .b-share__handle{height:auto;padding:0!important}</style></head>

<body topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0">
<a name="top" id="top"></a>
  <table align="center" border="0" cellpadding="0" cellspacing="0" width="780">
    <tbody><tr height="20">
      <td>&nbsp;</td>
      <td width="100%">&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td background="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20(%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE)_files/shad_left.gif" valign="top">
      <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/shad_top_left.gif" border="0" height="17" width="11"></td>
      <td valign="top" width="100%">
      <table bgcolor="#000000" border="0" cellspacing="1" width="100%">
        <tbody><tr>
          <td width="100%">
            <table border="0" cellpadding="0" cellspacing="0" width="100%">
              <tbody><tr>
                <td class="pathway" align="left" valign="center"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/arrow.png" hspace="5"><span class="pathway"><a href="http://microsin.ru/" class="pathway">Главная</a> <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/arrow.png" alt="arrow"> <a href="http://microsin.ru/content/section/5/44/" class="pathway">Программирование</a> <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/arrow.png" alt="arrow"> <a href="http://microsin.ru/content/category/5/26/44/" class="pathway">AVR</a> <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/arrow.png" alt="arrow">   USB in a NutShell - путеводитель по стандарту USB (начало) </span></td>
                <td class="pathway" align="right" valign="center">Tuesday, October 20 2015&nbsp;&nbsp;</td>
              </tr>
            </tbody></table>
          </td>
        </tr>
        <tr height="80">
          <td background="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20(%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE)_files/logo_bar_back.gif" bgcolor="#54647A" width="100%"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/logo_bar_logo.jpg" border="0"></td>
        </tr>
        <tr>
          <td background="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20(%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE)_files/but_bar_back.gif" bgcolor="#AFC6DB" width="100%">
          <table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td width="2"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/but_bar_divider.gif"></td><td align="center" width="20%"><a class="buttonbar" href="http://microsin.ru/index.php?option=com_frontpage&amp;Itemid=1">Главная</a></td><td width="2"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/but_bar_divider.gif"></td><td align="center" width="20%"><a class="buttonbar" href="http://microsin.ru/index.php?option=com_content&amp;task=view&amp;id=383&amp;Itemid=45">Контакты</a></td><td width="2"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/but_bar_divider.gif"></td><td align="center" width="20%"><a class="buttonbar" href="http://microsin.ru/index.php?option=com_content&amp;task=section&amp;id=4&amp;Itemid=43">Администрирование</a></td><td width="2"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/but_bar_divider.gif"></td><td align="center" width="20%"><a class="buttonbar" href="http://microsin.ru/index.php?option=com_content&amp;task=section&amp;id=5&amp;Itemid=44">Программирование</a></td><td width="2"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/but_bar_divider.gif"></td><td align="center" width="20%"><a class="buttonbar" href="http://microsin.ru/index.php?option=com_weblinks&amp;catid=15&amp;Itemid=34">Ссылки</a></td><td width="2"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/but_bar_divider.gif"></td></tr></tbody></table>          </td>
        </tr>
        <tr>
          <td bgcolor="#FFFFFF" width="100%">
          <table style="border-collapse: collapse" id="AutoNumber1" border="0" cellpadding="4" cellspacing="0" width="100%">
            <tbody><tr>
              <!-- LEFT Modules -->
                                <td bgcolor="#F0F0F0" valign="top" width="150">
                    <div class="modules">
                    		<table class="moduletable" cellpadding="0" cellspacing="0">
				<tbody><tr>
			<td>
				<noindex><table border="0">
	<tbody>
		<tr>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/UK-flag-ico.png" alt="UK-flag-ico.png" title="English site version" align="bottom"></td>
			<td><a href="http://translate.google.ru/translate?hl=ru&amp;sl=ru&amp;tl=en&amp;u=http%3A%2F%2Fmicrosin.ru%2F">English Version</a></td>
		</tr>
		<tr>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/GERMAN-flag-ico.png" alt="GERMAN-flag-ico.png" title="Die deutsche Version der Webseite" align="bottom"></td>
			<td><a href="http://translate.google.ru/translate?hl=ru&amp;sl=ru&amp;tl=de&amp;u=http%3A%2F%2Fmicrosin.ru%2F">Die deutsche Version</a></td>
		</tr>
	</tbody>
</table></noindex>			</td>
		</tr>
		</tbody></table>
				<table class="moduletable" cellpadding="0" cellspacing="0">
				<tbody><tr>
			<td>
				<!--<a href=http://microsin.ru/index.php?option=com_xmap&sitemap=1>  Карта сайта  </a>-->
<table border="0">
	<tbody>
		<tr>
			<td><a href="http://microsin.ru/index.php?option=com_rd_rss&amp;id=3" target="_self"></a><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/map.gif" alt="map.gif" title="карта сайта" style="margin: 5px" class="jce_tooltip" align="bottom">
			</td>
			<td><a target="_self" href="http://microsin.ru/index.php?option=com_xmap&amp;sitemap=1">карта сайта</a>
			</td>
		</tr>
	</tbody>
</table>			</td>
		</tr>
		</tbody></table>
				<table class="moduletable" cellpadding="0" cellspacing="0">
				<tbody><tr>
			<td>
				
<form action="index.php?option=com_search" method="get">
	<div class="search">
		<input name="searchword" id="mod_search_searchword" maxlength="20" alt="search" class="inputbox" size="26" value="поиск..." onblur="if(this.value=='') this.value='поиск...';" onfocus="if(this.value=='поиск...') this.value='';" type="text">	</div>

	<input name="option" value="com_search" type="hidden">
	<input name="Itemid" value="" type="hidden">	
</form>			</td>
		</tr>
		</tbody></table>
				<table class="moduletable" cellpadding="0" cellspacing="0">
					<tbody><tr>
				<th valign="top">
					нашли опечатку?				</th>
			</tr>
					<tr>
			<td>
				<p align="justify">
Пожалуйста, сообщите об этом - просто выделите ошибочное слово или фразу и нажмите <strong>Shift Enter</strong>.
</p>
			</td>
		</tr>
		</tbody></table>
				<table class="moduletable" cellpadding="0" cellspacing="0">
					<tbody><tr>
				<th valign="top">
					Поделиться:				</th>
			</tr>
					<tr>
			<td>
				<!-- http://api.yandex.ru/share/ -->
<script type="text/javascript" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/share.js" charset="utf-8"></script> <div class="yashare-auto-init" data-yasharel10n="ru" data-yasharetype="none" data-yasharequickservices="vkontakte,facebook,twitter,moimir,lj,yaru,friendfeed"><span class="b-share"><a rel="nofollow" target="_blank" title="ВКонтакте" class="b-share__handle b-share__link b-share-btn__vkontakte" href="https://share.yandex.net/go.xml?service=vkontakte&amp;url=http%3A%2F%2Fmicrosin.ru%2Fcontent%2Fview%2F1107%2F44%2F&amp;title=microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29" data-service="vkontakte"><span class="b-share-icon b-share-icon_vkontakte"></span></a><a rel="nofollow" target="_blank" title="Facebook" class="b-share__handle b-share__link b-share-btn__facebook" href="https://share.yandex.net/go.xml?service=facebook&amp;url=http%3A%2F%2Fmicrosin.ru%2Fcontent%2Fview%2F1107%2F44%2F&amp;title=microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29" data-service="facebook"><span class="b-share-icon b-share-icon_facebook"></span></a><a rel="nofollow" target="_blank" title="Twitter" class="b-share__handle b-share__link b-share-btn__twitter" href="https://share.yandex.net/go.xml?service=twitter&amp;url=http%3A%2F%2Fmicrosin.ru%2Fcontent%2Fview%2F1107%2F44%2F&amp;title=microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29" data-service="twitter"><span class="b-share-icon b-share-icon_twitter"></span></a><a rel="nofollow" target="_blank" title="Мой Мир" class="b-share__handle b-share__link b-share-btn__moimir" href="https://share.yandex.net/go.xml?service=moimir&amp;url=http%3A%2F%2Fmicrosin.ru%2Fcontent%2Fview%2F1107%2F44%2F&amp;title=microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29" data-service="moimir"><span class="b-share-icon b-share-icon_moimir"></span></a><a rel="nofollow" target="_blank" title="LiveJournal" class="b-share__handle b-share__link b-share-btn__lj" href="https://share.yandex.net/go.xml?service=lj&amp;url=http%3A%2F%2Fmicrosin.ru%2Fcontent%2Fview%2F1107%2F44%2F&amp;title=microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29" data-service="lj"><span class="b-share-icon b-share-icon_lj"></span></a></span></div>			</td>
		</tr>
		</tbody></table>
				<table class="moduletable" cellpadding="0" cellspacing="0">
				<tbody><tr>
			<td>
							</td>
		</tr>
		</tbody></table>
				<table class="moduletable" cellpadding="0" cellspacing="0">
				<tbody><tr>
			<td>
				<script type="text/javascript"><!--
google_ad_client = "pub-0017271818132240";
/* 120x90, создано 01.04.09 */
google_ad_slot = "3220443019";
google_ad_width = 120;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/show_ads.js">
</script>			</td>
		</tr>
		</tbody></table>
				<table class="moduletable" cellpadding="0" cellspacing="0">
				<tbody><tr>
			<td>
				<noindex>
<!--LiveInternet counter--><script type="text/javascript"><!--
document.write("<a href='http://www.liveinternet.ru/stat/microsin.ru/' "+
"target=_blank><img src='http://counter.yadro.ru/hit?t15.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";"+Math.random()+
"' alt='' title='LiveInternet: показано число просмотров за 24"+
" часа, посетителей за 24 часа и за сегодня' "+
"border='0' width='88' height='31'><\/a>")
//--></script><a href="http://www.liveinternet.ru/stat/microsin.ru/" target="_blank"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/hit.gif" alt="" title="LiveInternet: показано число просмотров за 24 часа, посетителей за 24 часа и за сегодня" border="0" height="31" width="88"></a><!--/LiveInternet-->
</noindex>
			</td>
		</tr>
		</tbody></table>
				<table class="moduletable" cellpadding="0" cellspacing="0">
				<tbody><tr>
			<td>
				<div id="RTBDIV_9862"> 
        <div id="RTBPL_9862"> 
            <a href="http://rtbsystem.com/ru/advertiser/request">Добавить рекламное объявление</a> 
        </div> 
</div> 
<script type="text/javascript"> 
    if (document.getElementById('RTBDIV_9862')) { 
        var I9862SD = new Date(); 
        document.write('<scr'+'ipt type="text/javascript" async ' 
            +'src="http://code.rtbsystem.com/9862.js?t='+I9862SD.getYear()+I9862SD.getMonth() 
            +I9862SD.getDay()+I9862SD.getHours() + '" charset="utf-8" ></scr'+'ipt>'); 
    } 
</script><script type="text/javascript" async="" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/9862.js" charset="utf-8"></script>			</td>
		</tr>
		</tbody></table>
		<br> <!-- это для отступа от последнего модуля -->
                    </div>
                  </td>
                                <td valign="top">
              <!-- Top Modules -->
                            				<table class="contentpaneopen">
			<tbody><tr>
								<td class="contentheading" width="100%">
					USB in a NutShell - путеводитель по стандарту USB (начало)									</td>
								<td class="buttonheading" align="right" width="100%">
					<a href="http://microsin.ru/index2.php?option=com_content&amp;task=view&amp;id=1107&amp;pop=1&amp;page=0&amp;Itemid=44" target="_blank" onclick="window.open('http://microsin.ru/index2.php?option=com_content&amp;task=view&amp;id=1107&amp;pop=1&amp;page=0&amp;Itemid=44','win2','status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=640,height=480,directories=no,location=no'); return false;" title="Версия для печати">
						<img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/printButton.png" alt="Версия для печати" name="Версия для печати" align="middle" border="0"></a>
				</td>
							</tr>
			</tbody></table>
			
		<table class="contentpaneopen">
					<tbody><tr>
				<td colspan="2" align="left" valign="top" width="70%">
					<span class="small">
						 Написал microsin					</span>
					&nbsp;&nbsp;
				</td>
			</tr>
						<tr>
				<td colspan="2" class="createdate" valign="top">
					28.02.2010				</td>
			</tr>
					<tr>
			<td colspan="2" valign="top">
				<p>
Здесь опубликован перевод на русский язык уникального документа <b>USB in a NutShell</b>,
 облегчающего разработчикам всего мира первое знакомство с протоколом 
USB. Наилучшая точка старта для новичков, и неплохое средство прочистить
 мозги более опытным разработчикам (которым кажется, что они что-то 
знают). Если какие-то термины и сокращения будут непонятны, пользуйтесь 
разделом [<a href="http://microsin.ru/content/view/1109/44#Terms" target="_self">Термины</a>] в конце статьи.
</p>


<p>
[<b>Глава 1: введение</b>]
</p>
<p>
Начало работы с протоколом <b>USB</b> выглядит устрашающе. Например, одна только <a href="http://www.usb.org/developers/docs/usb_20.zip" target="_self">документация стандарта USB 2.0</a> на 650 страниц может оттолкнуть любого новичка. И это только начало длинного списка связанных стандартов для USB. <a href="http://www.usb.org/developers/devclass/" target="_self">Стандарты классов USB</a>, как например <b>HID Class Specification</b>
 с общим описанием работы устройств (клавиатур, мышей, и т. д.), 
попадающих в класс HID (Human Interface Devices) – занимают еще 97 
страниц. Если Вы разрабатываете USB хост, то нужно выбрать один из трех 
стандартов интерфейса хоста (<b>Host Controller Interface Standards</b>). Ни один из них не детализирован в спецификации USB 2.0.
</p>
<p>
Хорошие новости – нет необходимости читать весь стандарт USB. Некоторые 
главы вышли из стен маркетинга, другие посвящены нижнему уровню, о 
котором заботится Ваша микросхема USB контроллера и хост вместе с 
разработчиками хаба. Давайте немного попутешествуем по различным главам 
спецификации USB 2.0, и кратко рассмотрим основные моменты.
</p>
<table style="border: 1px solid #000000" border="1" cellpadding="0" cellspacing="0">
	<tbody>
		<tr bordercolor="#000000" bgcolor="#0000ff">
			<td><b><span style="color: #ffffff">Главы</span></b></td>
			<td><b><span style="color: #ffffff">Название</span></b></td>
			<td><b><span style="color: #ffffff">Описание</span></b></td>
			<td><b><span style="color: #ffffff">Страниц</span></b></td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>1</td>
			<td>Введение</td>
			<td>Включает предназначение и область действия для USB. Самая важная 
часть информации в этой части – ссылка на Universal Serial Bus Device 
Class Specifications. <b>Нет необходимости читать эту главу</b>.</td>
			<td>2</td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>2</td>
			<td>Термины и аббревиатуры</td>
			<td>Это глава не требует пояснений – обычное зло любого стандарта.</td>
			<td>8</td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>3</td>
			<td>Основные вопросы</td>
			<td>Указывает цели USB, такие как Plug’n’Play и простота работы с ним конечного пользователя (<i>не разработчика</i>). Представляет скорости Low, Full and High Speed со списком возможностей, полученных для целей маркетинга. <b>Нет необходимости читать эту главу</b>.</td>
			<td>4</td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>4</td>
			<td>Обзор архитектуры</td>
			<td>Тут можно начать чтение. Эта часть предоставляет основной обзор 
системы USB включая топологию, скорости передачи данных, типы потоков 
данных, основные электрические параметры и т. д.</td>
			<td>10</td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>5</td>
			<td>Модель потока данных USB (Data Flow Model)</td>
			<td>Эта глава начинает рассказ о том, как передаются данные по 
Универсальной Последовательной Шине (Universal Serial Bus). Тут вводят и
 описывают такие термины как endpoints (конечные точки) пайпы или потоки
 (pipes). Большая часть главы посвящена каждому типу потока данных 
(Control, Interrupt, Isochronous и Bulk). Важно знать каждый тип 
передачи и его свойства, хотя это несколько тяжело для новичка.</td>
			<td>60</td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>6</td>
			<td>Механика</td>
			<td>Глава описывает два стандартных коннектора. Здесь важная 
информация – коннектор type A направлен на downstream (в сторону 
устройств USB) и коннектор type B направлен на upstream (в сторону хоста
 USB). Таким способом исключается возможность воткнуть кабель в два 
порта upstream. Все отсоединяемые кабели должны быть full/high speed, в 
то время как любой кабель low speed должен иметь подходящую цоколевку. 
Бегло просмотрев коннекторы, Вы можете пропустить эту часть, если не 
собираетесь заниматься производством коннекторов USB и/или кабелей. 
Разработчики PCB могут найти стандартные посадочные места (footprints) 
коннекторов.</td>
			<td>33</td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>7</td>
			<td>Электрика</td>
			<td>Глава рассматривает низкий уровень электрических сигналов, 
включая сопротивление линии, интервалы времени нарастания/спада, 
спецификации драйвера (передатчика)/приемника и кодирование уровня бита,
 bit stuffing и т. д. Наиболее важные части этой главы описывают 
идентификацию скорости устройства путем подключения смещающего уровень 
резистора на одной из линий данных, а также сравнение bus powered 
devices и self powered devices. Можете проскочить через эту главу, если 
Вы не разрабатываете микросхемы приемопередатчиков USB. Хороший даташит 
на устройства USB (микросхему) описывает величину терминирующих шину 
резисторов, которые Вам понадобятся, чтобы соблюсти сопротивление шины.</td>
			<td>75</td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>8</td>
			<td>Слой протокола</td>
			<td>Теперь мы начинаем рассматривать уровни протокола. Эта глава 
описывает пакеты USB на уровне отдельных байт, включая поля sync, pid, 
address, endpoint, CRC. После этого происходит переход на следующий слой
 протоколов, USB пакеты. Большинство разработчиков не обращает внимания 
на эти низкоуровневые слои протокола, так как применяемые ими микросхемы
 для устройств USB сами заботятся о них. Однако здесь важны понимание 
процедуры получения информации о статусе (status reporting) и процедуры 
установления связи (handshaking).</td>
			<td>45</td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>9</td>
			<td>Фреймворк устройства USB</td>
			<td>Это наиболее часто используемая глава во всей спецификации, и 
только одна из всех, которую я потрудился распечатать и переплести. Она 
описывает энумерацию шины и коды запросов (request codes - set address, 
get descriptor и т. п), наиболее используемый в программировании слой 
протоколов USB, важный для программистов и дизайнеров. <b>Эта глава должна быть тщательно прочитана</b>.</td>
			<td>36</td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>10</td>
			<td>Аппаратура и программное обеспечение хоста USB</td>
			<td>Эта глава покрывает проблемы, касающиеся хоста. Описываются 
генерация фреймов и микрофреймов, требования к контроллеру хоста, 
программные механизмы и драйверная модельUSB. Можете пропустить эту 
главу, если Вы не разрабатываете хост USB.</td>
			<td>23</td>
		</tr>
		<tr bordercolor="#000000" bgcolor="#ffff66">
			<td>11</td>
			<td>Описание хаба</td>
			<td>Описывает работу хабов USB включая конфигурацию хаба, разделение 
транзакций, стандартные дескрипторы для класса хаба и т. п. Можете 
пропустить эту главу, если Вы не разрабатываете хабы.</td>
			<td>143</td>
		</tr>
	</tbody>
</table>
<p>
Теперь можно начать читать те части стандарта, которые нам действительно
 нужны. Если Вы разрабатываете драйвера (программное обеспечение) для 
периферии USB, то Вам понадобятся только следующие части:
</p>
<ul>
	<li>4 - Обзор архитектуры</li>
	<li>5 - Модель потока данных USB (Data Flow Model)</li>
	<li>9 - Фреймворк устройства USB</li>
	<li>10 - Аппаратура и программное обеспечение хоста USB.</li>
</ul>
<p>
Разработчикам железа периферии (электроника) понадобятся только следующие главы:
</p>
<ul>
	<li>4 - Обзор архитектуры</li>
	<li>5 - Модель потока данных USB (Data Flow Model)</li>
	<li>6 - Механика</li>
	<li>7 - Электрика.</li>
</ul>
<p>
<span style="color: #339966"><b>USB in a NutShell для дизайнеров периферии</b></span>
</p>
<p>
Теперь допустим (и это наверняка правда) что (1) большинство из нас 
разрабатывают периферию USB и (2) прочитали стандарт, но после этого в 
голове никаких идей по поводу того, как все-таки реализовать 
разрабатываемое устройство. В следующих 7 главах мы сфокусируемся на 
необходимых в разработке устройства USB частях стандарта. Это позволит 
Вам «воткнуться» в USB и производить дальнейшие разработки в 
соответствии с Вашим приложением (назначением устройства USB).
</p>
<p>
Стандарт USB 1.1 был недостаточно сложен для High Speed, и перерос в USB
 2.0. Чтобы упростить понимание фундаментальных принципов USB, мы 
пропустим многое, касающееся непосредственно устройств USB High Speed.
</p>
<p>
<span style="color: #339966"><b>Введение в Universal Serial Bus (USB)</b> </span>
</p>
<p>
USB версии 1.1 поддерживает две скорости – режим <b>full speed</b> 12 Mbits/s и режим <b>low speed</b>
 1.5 Mbits/s. Режим 1.5 Mbits/s медленнее, и менее чувствителен к EMI 
(помехам), чем уменьшает стоимость ферритовых колец и снижает требования
 к качеству компонентов. Например, кварцы могут быть заменены на дешевые
 резонаторы. USB 2.0, который в настоящее время господствует для 
десктопов и ноутбуков, поднимает планку до 480Mbits/s. Эти 480Mbits/s 
обозначены как режим <b>High Speed</b>, и по этому параметру он может конкурировать с последовательной шиной <b>Firewire</b>.
</p>
<p>
<span style="color: #339966"><b>Скорости USB</b></span>
</p>
<ul>
	<li>High Speed - 480Mbits/s</li>
	<li>Full Speed - 12Mbits/s</li>
	<li>Low Speed - 1.5Mbits/s</li>
</ul>
<p>
Universal Serial Bus – шина, управляемая исключительно хостом. На шине 
допустим один и только один хост. Спецификация USB сама по себе не 
поддерживает любую форму мультихостинга. Однако в спецификации <a href="http://www.beyondlogic.org/usb/otghost.htm">On-The-Go</a>,
 появившейся в стандарте USB 2.0, введен протокол Host Negotiation 
Protocol, который позволяет двум устройствам USB договориться, кто будет
 выполнять роль хоста. Это предназначено и ограничено одиночными 
подключениями точка-точка, например мобильный телефон – персональный 
органайзер, и не распространяется на хабы и конфигурации компьютеров. 
Хост USB ответственен за то, что предпринял все транзакции и выбрал 
полосу пропускания. Данные могут быть посланы методами различных 
транзакций, используя token-based протокол (протокол, основанный на 
символах).
</p>
<p>
По моему мнению, шинная топология USB несколько ограниченная. Одной из 
начальных целей USB было уменьшение количества кабелей, воткнутых в 
заднюю (или переднюю) стенку Вашего PC. Приверженцы Apple могут сказать,
 что эта идея пришла от Apple Desktop Bus, где клавиатура, мышь и другая
 периферия могут соединяться друг с другом (по топологии daisy chain), с
 использованием одного кабеля.
</p>
<p>
Однако USB использует топологию «tiered star» (многоярусная звезда), 
похожую на топологию 10BaseT Ethernet. Это предполагает возможное 
использование хабов, что добавляет неудобства – больше коробочек на 
Вашем столе и большее количество кабелей. Но это не так плохо, как может
 показаться поначалу. Многие устройства имеют интегрированные в себя 
хабы. Например, Ваша клавиатура может содержать хаб, подключенный к 
компьютеру. Ваша мышь и другие устройства (цифровая камера и т. п.) 
могут быть просто воткнуты в клавиатуру. Многие мониторы также имеют 
встроенный хаб.
</p>
<p>
Топология tiered star имеет некоторые преимущества перед простой 
топологией daisy chain. Первое – потребляемая мощность каждого 
устройства может отслеживаться, и переключения, перегрузки не влияют на 
работоспособность других устройств USB. Все high, full и low speed 
устройства могут поддерживаться одновременно – хаб отфильтровывает 
транзакции high speed и full speed, таким образом устройства с низкими 
скоростями не получают данные со слишком высокой скоростью.
</p>
<p>
Одновременно к одной шине USB может быть подключено до 127 устройств. 
Нужно больше устройств? – просто добавьте другой порт/хост. Многие 
старые хосты USB имели 2 порта, и многие производители сочли это 
недостаточным, и начали производство 4 и 5 портовых карт хоста и 
материнских плат, с внутренними портами USB (например, для жестких 
дисков). Ранние хосты имели один контроллер USB, и два порта разделяли 
между собой доступную полосу пропускания USB. Поскольку требования к 
полосе пропускания росли, мы теперь видим многопортовые платы с двумя 
или больше контроллерами, позволяющими организовать отдельные каналы для
 данных.
</p>
<p>
Контроллеры хоста USB имеют собственные спецификации. В стандарте USB 1.1 имеется две спецификации Host Controller Interface:
</p>
<ul>
	<li><a href="http://www.intel.com/technology/usb/spec.htm" target="_self">UHCI (Universal Host Controller Interface)</a>
 – спецификация, разработанная Intel, которая перекладывает большинство 
функций на программное обеспечение (Microsoft) и позволяет применить 
дешевую аппаратуру.</li>
	<li><a href="http://www.compaq.com/productinfo/development/openhci.html">OHCI (Open Host Controller Interface)</a>
 – спецификация, разработанная Compaq, Microsoft и National 
Semiconductor, где больше функций возложено на аппаратуру (Intel), что 
упрощает программное обеспечение. Типичное взаимодействие инженеров 
железа / программ. . .</li>
</ul>
<p>
С появлением USB 2.0 понадобилась новая спецификация Host Controller 
Interface Specification для описания деталей регистрового уровня, 
специфичного для USB 2.0. Родился <a href="http://developer.intel.com/technology/usb/ehcispec.htm">EHCI (Enhanced Host Controller Interface)</a>.
 Известные поставщики включая Intel, Compaq, NEC, Lucent и Microsoft 
объединились вместе, чтобы предоставить нам один стандарт интерфейса, и 
таким образом, только один новый драйвер для реализации в операционных 
системах. Вовремя.
</p>
<p>
USB носит имя, подразумевающее последовательную шину. Она использует 4 
экранированных провода, из которых два передают питание (+5v &amp; GND).
 Остальные два представляют витую пару (twisted pair) дифференциальных 
сигналов данных. Используется схема кодирования <b>NRZI</b> (Non Return 
to Zero Invert, без возврата к нулю с инверсией) для передачи данных с 
полем синхронизации для синхронизирования тактов хоста и приемника.
</p>
<p>
USB поддерживает «горячее» (plug’n’play) соединение с динамически 
загружаемыми и выгружаемыми драйверами. Пользователь просто втыкает 
устройство, подключая его тем самым к шине. Хост детектирует 
присоединение, опрашивает свежевставленное устройство и загружает 
подходящий драйвер, индицируя песочными часами на экране момент загрузки
 (если драйвер для устройства USB уже установлен в системе). Конечный 
пользователь не заботится ни о терминировании, ни об <b>IRQ</b> 
(прерываниях) и адресах портов, ни о перезагрузке компьютера 
(перезагрузка не требуется). Когда пользователь закончил работу с 
USB-устройством, он просто вынимает его (или отсоединяет кабель), хост 
обнаружит отсутствие устройства и автоматически выгрузит драйвер.
</p>
<p>
Загрузка (выбор) подходящего драйвера осуществляется по комбинации 
PID/VID (Product ID/Vendor ID). VID предоставляется организацией USB 
Implementor's forum за деньги, и это еще одна точка преткновения для 
USB. Последняя информация о ценах может быть найдена на сайте <a href="http://www.usb.org/developers/vendor/" target="_self">http://www.usb.org/developers/vendor/</a>.
</p>
<p>
Другие организации по стандартам предоставляют дополнительные VID для 
некоммерческого использования, такого как обучение, разработка и прочее 
(радиолюбительство). USB Implementors forum все-таки должен оказать эту 
услугу. В этих случаях Вы можете использовать VID, назначенный 
поставщику системы разработки. Например, большинство производителей 
чипов имеют комбинации <b>VID</b>/<b>PID</b>, которые Вы можете 
использовать для Ваших чипов, и будет известно, что эти VID/PID не 
существуют в коммерческих устройствах. Другие производители чипов могут 
даже продать Вам для Вашего коммерческого устройства личный PID, чтобы 
использовать его с VID производителя.
</p>
<p>
Другая более достойная внимания особенность USB - его режимы передачи. USB поддерживает <b>Control</b>, <b>Interrupt</b>, <b>Bulk</b> и <b>Isochronous</b>
 передачи. В то время как мы будем смотреть на другие режимы передачи 
позже, Изохронный режим позволяет устройству резервировать определеную 
часть от полосы пропускания с гарантируемым временем ожидания (latency).
 Это идеально для аудио и видео приложений, где перегрузка канала может 
привести к заметной потере данных или понижению частоты кадров. Каждый 
режим передачи предоставляет разработчику компромиссы в области 
детектирования ошибок и восстановления, гарантированного времени 
ожидания и полосы пропускания.
</p>
<p>
<a id="hardwareid" name="hardware" title="hardware"></a>[<b>Глава 2: Железо</b>]
</p>
<p>
<span style="color: #339966"><b>Коннекторы</b></span>
</p>
<p>
Все устройства имеют <b>upstream</b>-соединение к хосту, и все хосты имеют <b>downstream</b>-соединение
 к устройству. Коннекторы upstream и downstream механически не 
взаимозаменяемы, что устраняет недопустимые петлевые соединения на 
хабах, такие как подсоединение downstream-порта в downstream-порт. 
Обычно используют два вида соединителей, называемые type A и type B, 
которые показаны ниже.
</p>
<table border="0">
	<tbody>
		<tr>
			<td>
			<div style="text-align: center">
			<img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-contypea.gif" class="jce_tooltip" style="margin: 5px; width: 109px; height: 45px" title="Type A USB Connector (сокет, нумерация контактов при виде снаружи)" alt="USBinNutShell-contypea.gif" height="45" width="109">
			</div>
			</td>
			<td></td>
			<td>
			<div style="text-align: center">
			<img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-contypeb.gif" class="jce_tooltip" style="margin: 5px; width: 54px; height: 53px" title="Type B USB Connector (сокет, нумерация контактов при виде снаружи)" alt="USBinNutShell-contypeb.gif" height="53" width="54">
			</div>
			</td>
		</tr>
		<tr>
			<td align="center">Type A USB Connector <br>
			(сокет, нумерация контактов <br>
			при виде снаружи)</td>
			<td></td>
			<td align="center">Type B USB Connector <br>
			(сокет, нумерация контактов <br>
			при виде снаружи)</td>
		</tr>
	</tbody>
</table>
<p>
Type A plug (т. е. папа) всегда обращен к upstream (т. е. к хосту). Type
 A socket (т. е мама) обычно можно найти на стенке хоста и хаба. 
Например, сокеты type A расположены на компьютерных материнских платах и
 хабах. Type B plug всегда соединяются с downstream и, следовательно, 
type B socket расположены на USB устройствах. На первый взгляд звучит 
довольно путано, но разобраться можно =).
</p>
<p>
Интересно обнаружить в некоторых компьютерных магазинах кабели type A 
&lt;--&gt; type A с прямой разводкой проводов и многочисленные зарядники
 USB-типа. Это входит в противоречие со спецификацией USB. Устройства, 
являющиеся переходником между штеккером type A в штеккер type A являются
 мостом, используемым для соединения двух компьютеров друг с другом. 
Другие запрещенные кабели – удлинители USB, имеющие на одном конце 
штеккер (либо type A, либо type B) и сокет на другом конце (либо type A,
 либо type B). Эти кабели нарушают требования к длине кабелей USB.<!------><!------><!------><!------><!------><!------><!------>
</p>
<p>
USB 2.0 включает в себя errata, которое представляет коннекторы mini-usb
 B. Подробная информация по этим коннекторам может быть найдена в <a href="http://www.usb.org/developers/data/ecn1.pdf">Mini-B Connector Engineering Change Notice</a>.
 Причина появления коннекторов mini появилась для применения USB в 
малогабаритных электронных устройствах типа мобильный телефоны и 
органайзеры. Обычный коннектор type B слишком большой, чтобы его можно 
было просто применить в этих устройствах.
</p>
<p>
Совсем недавно была разработана спецификация <a href="http://www.beyondlogic.org/usb/otghost.htm">On-The-Go</a>,
 которая добавляет для USB функциональность peer-to-peer. Она 
представляет хосты USB в мобильных телефонах и электронных органайзерах,
 и таким образом включена спецификация для mini-A джеков, mini-A 
разъемов и mini-AB разъемов. Я предполагаю, что скоро получат широкое 
распространение кабели mini USB, и также набор кабелей-конвертеров mini в
 standard.
</p>
<table style="border-width: 1px; width: 396px" border="1" cellpadding="0" cellspacing="1">
	<tbody>
		<tr bgcolor="#0000ff">
			<td valign="top" width="33%"><span style="color: #ffffff"><b>Номер контакта</b></span></td>
			<td valign="top" width="33%"><span style="color: #ffffff"><b>Цвет провода</b></span></td>
			<td valign="top" width="33%"><span style="color: #ffffff"><b>Функция</b></span></td>
		</tr>
		<tr bgcolor="#ffff66">
			<td valign="top" width="33%">1</td>
			<td valign="top" width="33%">Красный</td>
			<td valign="top" width="33%">VBUS (5 вольт)</td>
		</tr>
		<tr bgcolor="#ffff66">
			<td valign="top" width="33%">2</td>
			<td valign="top" width="33%">Белый</td>
			<td valign="top" width="33%">D-</td>
		</tr>
		<tr bgcolor="#ffff66">
			<td valign="top" width="33%">3</td>
			<td valign="top" width="33%">Зеленый</td>
			<td valign="top" width="33%">D+</td>
		</tr>
		<tr bgcolor="#ffff66">
			<td valign="top" width="33%">4</td>
			<td valign="top" width="33%">Черный</td>
			<td valign="top" width="33%">Земля</td>
		</tr>
	</tbody>
</table>
<p>
В кабелях USB используется стандартная цветовая маркировка для изоляции 
внутренних проводников, что упрощает идентификацию проводов от 
производителя к производителю. Стандарт регламентирует различные 
электрические параметры для кабелей. Интересно подробно прочитать 
включенные оригинальные спецификации USB 1.0. Вы бы разобрались в 
указанных электрических атрибутах, но параграф 6.3.1.2 предлагает 
рекомендованный цвет для заполнения кабелей USB морозный белый – как 
скучно! USB 1.1 и USB 2.0 послабляют рекомендации на Черный, Серый или 
Натуральный.
</p>
<p>
Разработчики PCB в части 6 стандарта найдут стандартные посадочные места и цоколевки коннекторов.
</p>
<p>
<span style="color: #339966"><b>Электрическая спецификация </b></span>
</p>
<p>
Вам не нужны электрические спецификации главы 7, за исключением если Вы 
не разрабатываете чипы USB устройств/трансиверов или USB хост/хаб. Мы 
бегло рассмотрим основные вопросы этой главы.
</p>
<p>
Как мы уже упоминали, USB использует для передачи данных пару проводов. 
Для кодирования применяется принцип NRZI (Not Return Zero Invert – без 
возврата к нулю с инверсией), и применяется вставка бит (bit stuffing), 
чтобы обеспечить нужные изменения уровня в потоке данных. На 
низкоскоростных (low speed) и полноскоростных (full speed) устройствах 
дифференциальная ‘1’ передается путем повышения уровня D+ свыше +2.8V 
резистором 15КОм, подключенным к +3.6V и D- ниже +0.3V резистором 
1.5КОм, подключенным к земле. Дифференциальный ‘0’ передается тем же 
способом, только уровни меняются на противоположные - D- свыше 2.8V и D+
 ниже 0.3V. <br>
Приемник распознает дифференциальную ‘1’, если уровень D+ больше на 
200mV, чем D-, и дифференциальный ‘0’, если D+ на 200mV меньше, чем D-. 
Полярность сигнала инвертируется в зависимости от скорости шины. Термины
 состояний ‘J’ и ‘K’ используются для обозначения логических уровней. На
 low speed состояние ‘J’ – дифференциальный 0. На high speed состояние 
‘J’ – дифференциальный 1.
</p>
<p>
Трансиверы USB имеют одновременно дифференциальные и несимметричные 
одиночные (single ended) выходы. Определенные состояния шины обозначены 
несимметричными сигналами на D +, D- или обоими сразу. Например, сигнал 
SE0 несимметричный и может использоваться для обозначения сброса 
устройства, если он удерживается дольше 10 мс. Сигнал SE0 генерируется 
путем удержания и D- и D+ в низком уровне (&lt; 0.3V). О реализации 
несимметричных и дифференциальных выходов важно знать, если Вы 
используете трансивер и FPGA в качестве устройства USB. Вы не можете 
осуществить работу только с помощью дифференциального выхода.
</p>
<p>
Шина low speed/full speed имеет волновое сопротивление (characteristic 
impedance) 90 Ом +/- 15%. Таким образом, важно просмотреть даташит при 
выборе сопротивлений последовательных резисторов для D+ иD-. В любом 
хорошем даташите указаны величины сопротивлений и допуски на них.
</p>
<p>
Режим High Speed (480Mbits/s) использует постоянный ток 17.78 mA для передачи сигналов – с целью уменьшения шума.
</p>
<p>
<span style="color: #339966"><b>Идентификация скорости</b></span><a name="SpeedIdentification" title="SpeedIdentification"></a>
</p>
<p>
Устройство USB должно показать свою скорость путем подвешивания линии D+
 или D- к напряжению 3.3V. Устройство full speed, как показано на 
картинке ниже, использует pull up резистор, подключенный к D+ для 
указания хосту, что это устройство full speed device. Резисторы pull up 
на стороне устройства используются хостом или хабом для определения 
присутствия устройства на шине (подключено ли устройство в порт USB). 
Без pull up резистора считается, что к шине USB ничего не подключено. 
Некоторые устройства имеют этот резистор встроенным в чип (он может 
включаться и выключаться программно под управлением firmware), другие 
требуют наличия внешнего резистора. <br>
Возьмем для примера технологию SoftConnectTM Philips Semiconductor. При 
подключении к шине микроконтроллер инициализирует функцию устройства USB
 перед тем, как он разрешает pull up резистор для идентификации 
скорости, показывающий, что устройство подключено к шине. Если pull up 
резистор был подключен к Vbus, то это означает, что устройство сразу 
подключается к шине, как только оно воткнуто в порт USB. В этом случае 
хост может попытаться сбросить устройство и запросить дескриптор, когда 
микроконтроллер устройства еще не проинициализировал функцию устройства 
USB (не готов в обработке запросов USB).
</p>
<p>
Другие вендоры, такие как Cypress Semiconductor, также используют 
программируемый резистор для технологии Re-NumerationTM в своих 
устройствах EzUSB, где устройство при подключении сначала определяется 
как программируемое устройство USB, а потом, после загрузки в устройство
 программного обеспечения, отключается от шины и под управлением 
загруженного firmware проходит энумерацию как другое устройство USB (все
 это происходит незаметно для пользователя). Многие устройства EzUSB не 
имеют встроенной памяти Flash или OTP ROM для сохранения кода. Они 
загружают код через подключение по USB.
</p>
<table border="0">
	<tbody>
		<tr>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-fspullup.gif" class="jce_tooltip" style="margin: 5px; width: 466px; height: 308px" title="Рисунок 2: USB устройство Full Speed имеет pull up резистор, подключенный к D+" alt="USBinNutShell-fspullup.gif" align="bottom" height="308" width="466"></td>
		</tr>
		<tr align="center">
			<td>Рисунок 2: USB устройство Full Speed имеет pull up резистор, <br>
			подключенный к D+</td>
		</tr>
	</tbody>
</table>
<p>
&nbsp;
</p>
<table border="0">
	<tbody>
		<tr>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-lspullup.gif" class="jce_tooltip" style="margin: 5px; width: 453px; height: 318px" title="Рисунок 3: USB устройство Low Speed имеет pull up резистор, подключенный к D-" alt="USBinNutShell-lspullup.gif" align="bottom" height="318" width="453"></td>
		</tr>
		<tr align="center">
			<td>Рисунок 3: USB устройство Low Speed имеет pull up резистор, <br>
			подключенный к D-</td>
		</tr>
	</tbody>
</table>
<p>
Обратите внимание, что мы не рассматривали идентификацию скорости для 
режима High Speed. High speed начинают работу путем подсоединения на 
full speed (1.5k на 3.3V к сигналу D+). После установления соединения и 
сброса устройство переходит к соединению на high speed, если хаб или 
хост поддерживает это. Если резистор работает в режиме high speed, 
резистор pull up отключается для сохранения баланса линии.
</p>
<p>
Для совместимости устройства с USB 2.0 не требуется поддержка режима 
high-speed. Это позволяет производить более дешевые устройства, если 
скорость не важна. Это также имеет место для USB 1.1 low speed 
устройства, которое не обязано поддерживать full speed.
</p>
<p>
Однако высокоскоростное устройство не должно поддерживать режим низкой 
скорости. Оно должно только поддержать режим full speed для первого 
соединения, и затем перейти в режим high speed после успешного 
взаимодействия. USB 2.0 совместимое downstream устройство (хаб или хост)
 должен поддерживать все три режима - high speed, full speed и low 
speed.
</p>
<p>
<span style="color: #339966"><b>Питание (VBUS)</b></span>
</p>
<p>
Одна из выгод USB – устройства, питаемые от шины (bus-powered devices) –
 устройства, которые могут получать питание от шины и не требовать 
никаких дополнительных джеков или кабелей. Однако многие путаются в этой
 опции без рассмотрения нужных критериев.
</p>
<p>
USB устройство указывает свое энергопотребление в единицах 2mA в 
дескрипторе конфигурации, который мы будем детально рассматривать далее.
 Устройство не может увеличить энергопотребление свыше величины, 
указанной при энумерации, даже если у него пропадет внешнее питание. 
Имеется 3 класса функций USB:
</p>
<ul type="disc">
	<li>Low-power питаемые от шины функции</li>
	<li>High-power питаемые от шины функции</li>
	<li>Self-powered функции (с собственным отдельным питанием)</li>
</ul>
<p>
Low power питаемые от шины функции получают питание полностью только от 
VBUS и не могут потреблять больше, чем 1 юнит нагрузки (one unit load). 
Спецификация USB задает в качестве юнита нагрузки 100mA. Low power 
питаемые от шины функции должны быть также разработаны таким образом, 
чтобы могли работать при снижении напряжения на VBUS до 4.40V и 
повышении до 5.25V, замеренных на upstream коннекторе устройства. Для 
большинства устройств 3.3V обязательно применение LDO регуляторов.
</p>
<p>
High power питаемые от шины функции получают питание только от USB и не 
могут потреблять больше, чем 1 юнит нагрузки, пока они не будут 
сконфигурированы хостом, после чего они могут потреблять до 5 юнитов 
нагрузки (500mA Max), предоставленных в соответствии с запрошенной 
величиной из дескриптора. High power питаемые от шины функции должны 
быть способны проходить детектирование и энумерацию при напряжении 
минимум 4.40V. Когда проходит работа с полной нагрузкой, то минимум для 
VBUS составляет 4.75 V, и максимум 5.25V. Здесь также измерения 
происходят с разъема upstream.
</p>
<p>
Самопитаемые функции (self power functions) могут потреблять от шины до 1
 юнита нагрузки и получать остаток мощности от внешнего источника. При 
пропадании внешнего источника питания должна быть обеспечена возможность
 потребления от шины USB не больше, чем 1 юнит нагрузки. Самопитаемые 
функции проще в разработке, поскольку отсутствуют проблемы с 
потребляемой мощностью. Одноюнитовая нагрузка на шину позволяет 
проводить детектирование и энумерацию без основного/дополнительного 
источника питания.
</p>
<p>
Никакое устройство USB, независимо от типа питания не должно подавать 
питание на провод VBUS на своем upstream порту. Если VBUS пропадет, 
устройство должно в течение 10 секунд убрать питание с D+/D- pull-up 
резисторов, используемых для идентификации скорости.
</p>
<p>
Другое условие использования VBUS - пусковой ток, который должен быть 
ограничен. Это выделено в параграфе 7.2.4.1 спецификации USB и обычно 
пропускается. Пусковой ток происходит из-за наличия электрической 
емкости в Вашем устройстве между VBUS и землей. Поэтому спецификация 
указывает максимально допустимую развязывающую емкость, которую Вы 
можете иметь в своем устройстве - 10uF. Когда Вы отключаете устройство, 
возникает ЭДС самоиндукции от протекающего тока (за счет индуктивности 
кабеля USB), которая может достичь большой величины. Для защиты от этого
 должна присутствовать минимальная развязывающая емкость 1uF на VBUS.
</p>
<p>
Типичное питаемое от шины устройство не может потреблять ток свыше 
весьма разумной величины - 500mA. Вы можете спросить – какие осложнения 
тут могут быть? Может, Suspend Mode (режим приостановки)?
</p>
<p>
<span style="color: #339966"><b>Потребление в режиме приостановки (Suspend Mode)</b></span>
</p>
<p>
Suspend mode обязателен для всех устройств. Во время приостановки 
вступают в силу дополнительные ограничения. Максимальный ток 
приостановки пропорционален номинальной нагрузке в юнитах. Для 
устройства с током нагрузки в 1 юнит максимальный ток приостановки (по 
умолчанию) 500uA. Это включает ток от pull up резисторов на шине. В хабе
 имеются на обеих линиях D- и D+ pull down резисторы по 15 КОм. Эти pull
 down резисторы вместе с последовательно включенным резистором в 
устройстве (1.5 КОм pull up) создают общую нагрузку 16.5 КОм на VTERM 
обычно 3.3v. Таким образом, этот резистор потребляет 200uA еще до 
старта.
</p>
<p>
Кроме того, нужно принимать во внимание для многих устройств регулятор 
3.3V. Многие устройства USB работают от 3.3V, например - PDIUSBD11. 
Линейные регуляторы обычно весьма неэффективны при средних статических 
электрических токах порядка 600uA, поэтому требуются более эффективные 
и, таким образом, дорогие регуляторы. В большинстве случаев Вы должны 
также уменьшить тактовую частоту микроконтроллера или совсем остановить 
тактовую частоту микроконтроллера, чтобы уложиться в предел 500uA.
</p>
<p>
<span style="color: #c0c0c0">Примечание переводчика: многие разработчики
 firmware не утруждают себя обработкой режима Suspend. Например, среди 
разработок, основанных на библиотеке V-USB, мне не попадались проекты с 
поддержкой режима Suspend. </span>
</p>
<p>
Многие разработчики на форуме USB Implementor's Forum спрашивают – какие
 проблемы произойдут, если превысить лимит тока Suspend? Само собой 
разумеется, что большинство хостов и хабов не могут обнаружить 
перегрузку такой величины, и следовательно Ваше устройство может 
потреблять ток 5 мА и даже 10 мА и при этом нормально работать – но 
все-таки Вы при этом нарушаете требования спецификации USB. Однако при 
нормальном функционировании (не в режиме Suspend), если Вы пытаетесь 
превысить на 100mA Вашу определенную допустимую нагружку, то хаб или 
хост наверняка обнаружат это и отсоединят Ваше устройство в интересах 
целостности шины. <br>
Конечно, этих вопросов проектирования можно избежать, если Вы хотите 
спроектировать устройство USB с собственным питанием. Токи Suspend не 
имеют значения для десктопов, но с введением спецификации On-The-Go 
хостами USB могут стать мобильные телефоны и мобильные органайзеры. 
Лишнее потребление энергии Вашими USB устройствами произведет 
неблагоприятный эффект на время работы мобильного устройства от батареи.
</p>
<p>
<span style="color: #339966"><b>Вход в Suspend Mode</b></span>
</p>
<p>
Устройство USB приостанавливается (переходит в режим Suspend), когда на 
шине нет активности более чем 3.0 мс. В течение следующих 7 мс 
устройство должно отключиться, и не потреблять ток больше, чем заданный 
ток suspend. Таким образом, через 10 мс после прекращения активности 
шины ток потребления от неё не должен превышать suspend current. Для 
поддержания состояния соединения к приостановленному хабу или хосту, 
устройство во время режима Suspend должно все еще предоставлять питание 
на pull up нагрузочный резистор, определяющий выбор скорости.
</p>
<p>
У USB есть пакет start of frame (SOF), который строго периодично (каждые
 1 мс для low speed и full speed) посылается на шину для поддержания её в
 активном состоянии. Это препятствует тому, чтобы шина стала неактивной 
(вошла режим приостановки) при отсутствии данных на шине.
</p>
<ul type="disc">
	<li>Шина high speed имеет микрофреймы, отсылаемые каждые 125.0 µs ±62.5 ns.</li>
	<li>Шина full speed отправляет фрейм каждые 1.000 ms ±500 ns.</li>
	<li>Шина low speed имеет keep alive EOP (End of Packet) каждые 1ms только в случае отсутствия любых low speed данных.</li>
</ul>
<p>
Термин "Global Suspend" используется, когда вся шина USB входит в режим 
suspend целиком. Однако также может быть приостановлено выбранное 
устройство путем посылки команды хабу, куда подключено устройство. Это 
называют как "Selective Suspend."
</p>
<p>
Устройство возобновит работу, как только примет любой «не idle» сигнал. 
Если устройство имеет возможность удаленного пробуждения (remote wakeup 
enabled), то оно может сигнализировать хосту о необходимости выхода из 
режима Suspend (resume).
</p>
<p>
<span style="color: #339966"><b>Скорость сигнала данных (Data Signalling Rate)</b></span>
</p>
<p>
Другая область, которая часто пропускается, является допуск на такты 
USB. Эта информация имеется в секции 7.1.11 спецификации USB.
</p>
<ul type="disc">
	<li>High speed data тактируются 480.00Mb/s с допуском на скорость ± 500ppm.</li>
	<li>Full speed data тактируются 12.000Mb/s с допуском на скорость ±0.25% или 2,500ppm.</li>
	<li>Low speed data тактируются 1.50Mb/s с допуском на скорость ±1.5% или 15,000ppm.</li>
</ul>
<p>
Эти допуски позволяют для устройств low speed применять недорогие 
резонаторы, но исключает их для full speed или high speed устройств.
</p>
<p>
[<b>Глава 3: протоколы USB</b>]
</p>
<p>
В отличие от RS-232 и похожих последовательных интерфейсов, где формат 
отправляемых данных не задан, USB составлен из нескольких слоев 
протоколов. Звучит сложно, но не опускайте руки. Как только поймете, что
 происходит, нужно беспокоиться только о протоколах верхних уровней. 
Фактически большинство контроллеров USB берет на себя заботу о нижних 
уровнях протоколов, делая их невидимыми для конечного разработчика.
</p>
<p>
Каждая транзакция USB состоит из:
</p>
<ul type="circle">
	<li>Token Packet (заголовок, показывающий – что должно передаваться далее)</li>
	<li>необязательный Data Packet (содержит полезный payload)</li>
	<li>Status Packet (используется для подтверждения транзакций и предоставляет средство устранения ошибок)</li>
</ul>
<p>
Как мы уже упоминали - USB является шиной, где главным является хост. 
Хост начинает все транзакции. Первый пакет, так называемый token, 
генерируется хостом для описания того, что проследует далее и будет ли 
это транзакция чтения или записи, и какой адрес устройства и 
определенная конечная точка (endpoint). Следующий пакет обычно пакет 
данных, несущий полезную нагрузку, за которым идет пакет рукопожатия 
(handshaking packet), сообщающий о том, что данные или token были 
приняты успешно, или конечная точка (endpoint) остановлена (stalled) или
 недоступна для принятия данных.
</p>
<p>
<span style="color: #339966"><b>Общие поля пакета USB</b></span>
</p>
<p>
Данные на шине USB передаются в таком порядке: первым идет LSB (Least 
Significant Bit, младший значащий бит). Пакеты USB состоят из следующих 
полей:
</p>
<ul type="circle">
	<li>Sync</li>
</ul>
<p>
Все пакеты должны начинаться с поля синхронизации (sync). Поле sync 
имеет длину 8 бит на low speed и full speed или 32 бита на high speed, и
 используется для синхронизации тактов приемника с тактами передатчика. 
Последние 2 бита показывают, где начинается поле PID.
</p>
<ul type="circle">
	<li>PID</li>
</ul>
<p>
PID означает Packet ID. Это поле используется для обозначения типа 
пакета, который сейчас отправляется. Следующая таблица показывает 
возможные значения этого поля.
</p>
<table style="border-width: 1px; width: 349px" border="1" cellpadding="0">
	<tbody>
		<tr bgcolor="#0000ff">
			<td valign="top" width="24%"><b><span style="color: #ffffff">Группа</span></b></td>
			<td valign="top" width="24%"><b><span style="color: #ffffff">Значение PID</span></b></td>
			<td valign="top" width="51%"><b><span style="color: #ffffff">Идентификатор пакета </span></b></td>
		</tr>
		<tr bgcolor="#ffff66">
			<td rowspan="4" valign="top" width="24%">Token</td>
			<td valign="top" width="24%">0001</td>
			<td valign="top" width="51%">OUT Token</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">1001</td>
			<td bgcolor="#ffff66" valign="top" width="51%">IN Token</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">0101</td>
			<td bgcolor="#ffff66" valign="top" width="51%">SOF Token</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">1101</td>
			<td bgcolor="#ffff66" valign="top" width="51%">SETUP Token</td>
		</tr>
		<tr bgcolor="#ffff66">
			<td rowspan="4" valign="top" width="24%">Data</td>
			<td valign="top" width="24%">0011</td>
			<td valign="top" width="51%">DATA0</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">1011</td>
			<td bgcolor="#ffff66" valign="top" width="51%">DATA1</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">0111</td>
			<td bgcolor="#ffff66" valign="top" width="51%">DATA2</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">1111</td>
			<td bgcolor="#ffff66" valign="top" width="51%">MDATA</td>
		</tr>
		<tr bgcolor="#ffff66">
			<td rowspan="4" valign="top" width="24%">Handshake</td>
			<td valign="top" width="24%">0010</td>
			<td valign="top" width="51%">ACK Handshake</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">1010</td>
			<td bgcolor="#ffff66" valign="top" width="51%">NAK Handshake</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">1110</td>
			<td bgcolor="#ffff66" valign="top" width="51%">STALL Handshake</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">0110</td>
			<td bgcolor="#ffff66" valign="top" width="51%">NYET (No Response Yet)</td>
		</tr>
		<tr bgcolor="#ffff66">
			<td rowspan="4" valign="top" width="24%">Special</td>
			<td valign="top" width="24%">1100</td>
			<td valign="top" width="51%">PREamble</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">1100</td>
			<td bgcolor="#ffff66" valign="top" width="51%">ERR</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">1000</td>
			<td bgcolor="#ffff66" valign="top" width="51%">Split</td>
		</tr>
		<tr>
			<td bgcolor="#ffff66" valign="top" width="24%">0100</td>
			<td bgcolor="#ffff66" valign="top" width="51%">Ping</td>
		</tr>
	</tbody>
</table>
<p>
У PID здесь 4 бита, однако чтобы обеспечить его правильный прием, 4 бита
 дополнены (complemented) и повторены, в результате получился 8-битный 
PID. Полученный формат показан ниже:
</p>
<table style="border-width: 1px; width: 415px" border="1" cellpadding="0">
	<tbody>
		<tr bgcolor="#ffff66">
			<td align="center" valign="top" width="12%">PID0</td>
			<td align="center" valign="top" width="13%">PID1</td>
			<td align="center" valign="top" width="12%">PID2</td>
			<td align="center" valign="top" width="13%">PID3</td>
			<td align="center" valign="top" width="12%">nPID0</td>
			<td align="center" valign="top" width="12%">nPID1</td>
			<td align="center" valign="top" width="12%">nPID2</td>
			<td align="center" valign="top" width="12%">nPID3</td>
		</tr>
	</tbody>
</table>
<ul type="circle">
	<li>ADDR</li>
</ul>
<p>
Поле адреса указывает, какому из устройств USB предназначен пакет. Адрес
 имеет длину 7 бит, что позволяет адресовать до 127 поддерживаемых 
одновременно устройств. Адрес 0 недопустим, он предназначен для 
устройств, адрес для которых пока не назначен. Любое устройство, 
которому не назначен адрес, должно отвечать на пакет с адресом 0.
</p>
<ul type="circle">
	<li>ENDP</li>
</ul>
<p>
Поле endpoint составлено из 4 бит, что позволяет 16 возможных конечных 
точек. Однако устройства low speed могут иметь только 2 дополнительные 
конечные точки сверх заданного по умолчанию канала (4 конечных точки 
максимум).
</p>
<ul type="circle">
	<li>CRC</li>
</ul>
<p>
Cyclic Redundancy Checks (Циклическая Избыточная проверка) выполняется 
над данными в пределах полезной нагрузки пакета. Все пакеты token имеют 5
 бит CRC, а пакеты data имеют 16 бит CRC.
</p>
<ul type="circle">
	<li>EOP</li>
</ul>
<p>
End of packet, конец пакета. Сигнализируется несимметричным нулем 
(Single Ended Zero, SE0) на время примерно 2 бита, и далее следует 
состояние J длительностью 1 бит.
</p>
<p>
<span style="color: #339966"><b>Типы пакетов USB</b></span>
</p>
<p>
USB имеет 4 разных типа пакета. Пакеты token индицируют тип последующей 
транзакции, пакеты data содержат payload, пакеты handshake используются 
для подтверждения данных или сообщений об ошибках, и пакеты start of 
frame (SOF) показывают начало нового фрейма.
</p>
<ul type="circle">
	<li>пакеты Token</li>
</ul>
<p>
Имеется 3 типа пакетов token:
</p>
<p>
In – информируют устройство USB о том, что хост хочет прочитать информацию. <br>
Out - информируют устройство USB о том, что хост хочет отправить информацию. <br>
Setup – используется для начала управляющих передач (control transfers).
</p>
<p>
Пакеты token должны удовлетворять следующему формату:
</p>
<table style="border-width: 1px; width: 331px" border="1" cellpadding="0" cellspacing="3">
	<tbody>
		<tr bgcolor="#ffff66">
			<td width="18%">Sync</td>
			<td width="13%">PID</td>
			<td width="17%">ADDR</td>
			<td width="17%">ENDP</td>
			<td width="17%">CRC5</td>
			<td width="17%">EOP</td>
		</tr>
	</tbody>
</table>
<ul type="circle">
	<li>пакеты Data</li>
</ul>
<p>
Имеется 2 типа пакетов данных, каждый из которых может передать до 1024 байта данных.
</p>
<p>
Data0 <br>
Data1
</p>
<p>
Режим High Speed задает два других data PID - DATA2 и MDATA.<br>
Пакеты Data имеют следующий формат:
</p>
<table style="border-width: 1px; width: 331px" border="1" cellpadding="0">
	<tbody>
		<tr bgcolor="#ffff66">
			<td width="18%">Sync</td>
			<td width="13%">PID</td>
			<td width="35%">Data</td>
			<td width="17%">CRC16</td>
			<td width="17%">EOP</td>
		</tr>
	</tbody>
</table>
<p>
Максимальный размер полезной нагрузки (payload) для low-speed устройств 
составляет 8 байт. Максимальный размер полезной нагрузки для full-speed 
устройств составляет 1023 байт. Максимальный размер полезной нагрузки 
для high-speed устройств составляет 1024 байт. Данные нужно послать в 
единицах байт.
</p>
<ul>
	<li>пакеты Handshake</li>
</ul>
<p>
Имеется 3 типа пакетов handshake, которые состоят просто из PID
</p>
<p>
ACK – подтверждение о том, что пакет успешно принят. NAK – сообщение о 
том, что устройство временно не может отправить или принять данные. 
Также используется в interrupt транзакциях для информирования хоста о 
том, что нет никаких данных для передачи. STALL – устройство находится в
 состоянии, которое требует вмешательства со стороны хоста.
</p>
<p>
Пакеты handshake имеют следующий формат:
</p>
<table style="border-width: 1px; width: 160px" border="1" cellpadding="0">
	<tbody>
		<tr bgcolor="#ffff66">
			<td valign="top" width="37%">Sync</td>
			<td valign="top" width="27%">PID</td>
			<td valign="top" width="35%">EOP</td>
		</tr>
	</tbody>
</table>
<ul type="circle">
	<li>пакеты Start of Frame (SOF)</li>
</ul>
<p>
Пакет SOF состоит из 11-битного номера фрейма, отсылаемого хостом каждые
 1ms ± 500ns на full speed или каждые 125 µs ± 0.0625 µs на high speed.
</p>
<table style="border-width: 1px; width: 331px" border="1" cellpadding="0">
	<tbody>
		<tr bgcolor="#ffff66">
			<td width="18%">Sync</td>
			<td width="13%">PID</td>
			<td width="35%">Frame Number</td>
			<td width="17%">CRC5</td>
			<td width="17%">EOP</td>
		</tr>
	</tbody>
</table>
<p>
<span style="color: #339966"><b>Функции USB</b></span>
</p>
<p>
Когда мы представляем себе устройство USB, мы думаем о нем как о 
периферийном устройстве USB, но устройство USB могло означать USB 
трансивер, используемый в хосте или периферии, USB хаб или микросхему 
контроллера хоста, или периферийное устройство USB. Поэтому стандарт 
ссылается на функции USB, которые можно видеть как USB устройства, 
которые обеспечивают определенный функционал наподобие принтера, 
Zip-драйва, сканера, модема или другой периферии.
</p>
<p>
Сейчас мы уже должны знать ряд понятий, составляющих пакет USB. Нет? Вы 
уже забыли, сколько бит входит в поле PID? Не будьте слишком обеспокоены
 этим. К счастью, большинство функций USB уже в кремнии (специальных 
чипах) получают обработку низких уровней протокола USB (до слоя 
транзакций, который мы рассмотрим в следующей главе). Мы рассматриваем 
информацию о низких слоях протокола USB потому, что большинство 
контроллеров функций USB сообщают об ошибках, таких как PID Encoding 
Error. Не рассмотрев бегло низкий уровень, можно было бы спросить, что 
означает PID Encoding Error? Если бы Вы предположили, что последние 
четыре бита PID не соответствовали инверсии первых четырех битов, то Вы 
были бы правы.
</p>
<p>
<img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-endpoint.gif" class="jce_tooltip" style="margin: 5px; width: 593px; height: 365px" title="USBinNutShell-endpoint.gif" alt="USBinNutShell-endpoint.gif" align="bottom" height="365" width="593">
</p>
<p>
У большинства функций есть серия буферов, обычно 8 байт длиной. Каждый 
буфер будет принадлежать конечной точке (endpoint) - EP0 IN, EP0 OUT и 
т. п.. Например, хост отправляет запрос дескриптора устройства (device 
descriptor request). Функция аппаратно прочитает пакет setup и определит
 из поля адреса, предназначен ли пакет именно ей, и если да, то 
скопирует полезную нагрузку (payload) последующего пакета данных в 
соответствующий буфер конечной точки, заданный величиной в поле endpoint
 токена setup. Также отправится пакет handshake для подтверждения приема
 байта и сгенерируется внутреннее прерывание в микроконтроллере для 
соответствующей конечной точки, обозначающее, что пакет был принят. Все 
это делается обычно в «железе» (аппаратуре чипа контроллера USB 
устройства).
</p>
<p>
Программное обеспечение (firmware микроконтроллера) получит прерывание, в
 котором оно должно прочитать содержимое буфера конечной точки и 
проанализировать запрос на дескриптор устройства (parse device 
descriptor request). <b></b>
</p>
<p>
<span style="color: #339966"><b>Конечные точки (endpoints)</b></span>
</p>
<p>
Конечные точки могут быть описаны как источники или приемники данных. 
Поскольку шина является хосториентированной, конечные точки оказываются в
 конце канала связи, на функции USB. Например, на уровне программного 
обеспечения Ваш драйвер устройства может отправлять пакет в конечную 
точку EP1 устройства. Так как данные поступают от хоста, они попадут в 
OUT буфер EP1. Ваше firmware теперь может не спеша прочитать эти данные.
 Если устройство хочет вернуть данные, функция не может просто записать 
их на шину, так как шина полностью управляется хостом. Поэтому firmware 
помещает данные в буфер EP1 IN, и эти данные находятся в буфере до тех 
пор, пока хост не отправит пакет IN, которым он запрашивает данные 
конечной точки. Конечные точки можно также рассматривать как интерфейс 
между железом функции устройства и firmware, работающем на функции 
устройства. <br>
Все устройства должны поддерживать конечную точку 0. Это конечная точка,
 которая принимает все управляющие запросы и запросы статуса во время 
энумерации и в течение всего времени, когда устройство остается 
работоспособным на шине.
</p>
<p>
<span style="color: #339966"><b>Потоки, или каналы (Pipes, дословно - трубы)</b></span>
</p>
<p>
Когда устройство отправляет и принимает данные через несколько конечных 
точек, клиентское программное обеспечение передает данные через потоки. 
Поток – логическое соединение между хостом и конечной точкой (точками). 
Потоки также имеют набор параметров – тип передачи (Control, Bulk, Iso 
или Interrupt), направление потока данных и максимальные размеры 
пакета/буфера. Например, поток по умолчанию – двунаправленный поток, 
составленный из IN конечной точки 0 и OUT конечной точки 0 с типом 
передачи control. <br>
USB определяет два типа потоков (pipes)
</p>
<ul type="disc">
	<li><b>Stream Pipes</b> не имеют предопределенного USB формата, поэтому
 Вы можете послать данные любого типа через stream pipe и восстановить 
данные на другом конце. Потоки данных последовательны и имеют 
предопределенную направленность – IN или OUT. Stream pipes поддерживают 
типы передач bulk, isochronous и interrupt. Stream pipes могут 
управляться либо от хоста, либо от устройства.</li>
	<li><b>Message Pipes</b> имеют предопределенный USB формат. Они 
управляются хостом, инициируются запросом, отправляемым от хоста. Данные
 пересылаются в нужном направлении, заданном в запросе. Таким образом, 
message pipes позволяют передавать данные в обоих направлениях, но 
поддерживают только передачи control.</li>
</ul>
<p>
[<b>Глава 4: Типы конечных точек (Endpoint Types)</b>]
</p>
<p>
Стандарт USB определяет 4 типа конечных точек/передач:
</p>
<ul type="disc">
	<li><a href="http://microsin.ru/content/view/1107/44#Control" target="_self">Control</a></li>
	<li><a href="http://microsin.ru/content/view/1107/44#Interrupt" target="_self">Interrupt</a></li>
	<li><a href="http://microsin.ru/content/view/1107/44#Isochronous" target="_self">Isochronous</a></li>
	<li><b><b><a href="http://microsin.ru/content/view/1107/44#Bulk" target="_self">Bulk</a></b></b></li>
</ul>
<p>
<span style="color: #339966"><b>Передачи Control</b></span><a name="Control" title="Control"></a>
</p>
<p>
Управляющие передачи (control transfer) обычно используются для команд и
 операций получения состояния. Основная настройка устройства USB со 
всеми функциями энумерации происходит с использованием передач control. 
Это обычно быстрые, случайные по времени пакеты, инициированные хостом, 
которые имеют наилучший приоритет по доставке (best effort). Максимально
 допустимая длина полезной нагрузки (payload, или размер пакета) 
управляющей передачи полноскоростных (full-speed) устройств USB 
составляет 8, 16, 32 или 64 байта; для высокоскоростных (high-speed) 
устройств этот размер составляет 64 байта, и для низкоскоростных 
(low-speed) устройств это 8 байт (только 8 байт, и никаких других 
вариантов). <!-- 130212 Старый вариант перевода: Длина пакета для устройств low speed должна  быть 8 байт, для high speed разрешены размеры пакета 8, 16, 32 или 64 байт, и устройства  full speed должны  иметь размер пакета 64 байта.-->
</p>
<p>
У передач control могут быть до 3 стадий.
</p>
<ul type="disc">
	<li>Setup Stage – стадия установки, определяет, куда посылаются данные.
 Состоит из трех пакетов. Токен setup отправляется первым, он содержит 
адрес и номер конечной точки. Пакет данных (data packet) отправляется 
следующим, и всегда имеет тип PID data0 и включает <a href="http://microsin.ru/content/view/1108/44#SetupPacket" target="_self">setup packet</a>,
 который детализирует тип запроса. Мы позже подробно рассмотрим setup 
packet. Последний пакет из трех – рукопожатие (handshake), используемое 
для подтверждения успешности приема или для сообщения об ошибке. Если 
функция успешно приняла setup data (CRC, PID и т. п. в порядке), она 
отвечает рукопожатием (handshake) ACK, иначе игнорирует данные, не 
отправляя пакет handshake. Функция не может послать пакетамы STALL или 
NAK в ответ на пакет setup.
	<div align="center">
	<table border="0" cellpadding="0">
		<tbody>
			<tr>
				<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-contset.gif" alt="USBinNutShell-contset.gif" title="USBinNutShell-contset.gif" style="border: 0px none #000000; width: 320px; height: 142px" align="bottom" border="0" height="142" width="320"></td>
				<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-transkey.gif" alt="USBinNutShell-transkey.gif" title="USBinNutShell-transkey.gif" style="border: 0px none #000000; width: 125px; height: 27px" align="bottom" border="0" height="27" width="125"></td>
			</tr>
		</tbody>
	</table>
	</div>
	</li>
	<li>Data Stage – эта стадия необязательна. Она состоит из одной или 
нескольких передач IN или OUT. Запрос setup показывает, сколько данных 
будет передаваться на этой стадии. Если количество данных превышает 
максимальный размер пакета, данные будут переданы в нескольких 
передачах, каждая из которых (за исключением последней) имеет размер 
максимального пакета.</li>
</ul>
<p>
Стадия data stage имеет два различных сценария, в зависимости от направления передачи данных.
</p>
<p>
<b>Сценарий IN</b>: когда хост готов принять данные control data, он 
выпускает IN Token. Если функция получает IN token с ошибкой, например 
PID не соответствует инверитрованным битам PID, то она игнорирует пакет.
 Если токен принят успешно, устройство может либо ответить пакетом DATA,
 содержащим отправляемые control data, либо stall packet, индицирующий 
ошибку конечной точки, либо пакет NAK, показывающий хосту, что конечная 
точка работает, но пока не имеет данных для отправки.
</p>
<div align="center">
<table border="0" cellpadding="0">
	<tbody>
		<tr>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-contdata.gif" alt="USBinNutShell-contdata.gif" title="USBinNutShell-contdata.gif" style="border: 0px none #000000; width: 315px; height: 322px" align="bottom" border="0" height="322" width="315"></td>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-transkey.gif" alt="USBinNutShell-transkey.gif" title="USBinNutShell-transkey.gif" style="border: 0px none #000000; width: 125px; height: 27px" align="bottom" border="0" height="27" width="125"></td>
		</tr>
	</tbody>
</table>
</div>
<p>
<b>Сценарий OUT</b>: когда хосту нужно передать устройству пакет с 
управляющими данными (control data packet), он выпускает OUT token, за 
которым идет пакет, содержащий control data в качестве полезной 
нагрузки. Если любая часть – или OUT token, или data packet ошибочны, 
функция игнорирует пакет. Если буфер конечной точки пуст, она заполняет 
буфер данными и передает ACK, информирующий хост о том, что данные 
получены успешно. Если буфер конечной точки не пуст, поскольку идет 
обработка предыдущего пакета, функция отвечает NAK. Однако, если у 
оконечной точки была ошибка, и ее бит останова (halt bit) был 
установлен, она возвращает STALL.
</p>
<ul type="circle">
	<li>Status Stage сообщает состояние полного запроса, и меняется в 
зависимости от направления передачи. Функция всегда возвращает сообщение
 состояния.</li>
</ul>
<p>
Стадия status stage также имеет два различных сценария, в зависимости от направления передачи данных.
</p>
<p>
<b>Сценарий IN</b>: если хост отправил токен (токены) IN token(s) во 
время стадии data stage для приема данных, хост должен подтвердить 
успешный прием данных. Это делается путем отправки токена OUT, за 
которым идет пакет data нулевой длины. Функция может теперь сообщить 
свой статус на стадии handshaking. ACK указывает на то, что функция 
завершила команду и готова к приему следующей команды. Если во время 
обработки этой команды произошла ошибка, функция выдает STALL. Однако 
если пока продолжается обработка команды, функция выдает NAK, 
указывающий хосту повторить позже стадию status stage.
</p>
<div align="center">
<table border="0" cellpadding="0">
	<tbody>
		<tr>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-contsta1.gif" style="border: 0px none #000000; width: 336px; height: 119px" alt="USBinNutShell-contsta1.gif" title="USBinNutShell-contsta1.gif" align="bottom" border="0" height="119" width="336"></td>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-transkey.gif" alt="USBinNutShell-transkey.gif" title="USBinNutShell-transkey.gif" style="border: 0px none #000000; width: 125px; height: 27px" align="bottom" border="0" height="27" width="125"></td>
		</tr>
	</tbody>
</table>
</div>
<p>
<b>Сценарий OUT</b>: если хост отправил токен (токены) OUT на стадии 
data stage – чтобы отправить данные, функция подтверждает успешный прием
 данных отправкой пакета нулевой длины в ответ на токен IN. Однако если 
произошла ошибка, функция должна выдать STALL, или если пока 
обрабатываются данные, должна выдать NAK, указывая хосту повторить позже
 status phase.
</p>
<div align="center">
<table border="0" cellpadding="0">
	<tbody>
		<tr>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-contsta2.gif" style="border: 0px none #000000; width: 342px; height: 121px" alt="USBinNutShell-contsta2.gif" title="USBinNutShell-contsta2.gif" align="bottom" border="0" height="121" width="342"></td>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-transkey.gif" alt="USBinNutShell-transkey.gif" title="USBinNutShell-transkey.gif" style="border: 0px none #000000; width: 125px; height: 27px" align="bottom" border="0" height="27" width="125"></td>
		</tr>
	</tbody>
</table>
</div>
<p>
<span style="color: #339966"><b><b><b><b>Передачи Control: общий обзор</b></b></b></b></span>
</p>
<p>
Теперь, как все это совмещается? Например, хост хочет запросить 
дескриптор устройства во время энумерации. Пакеты, которые посылают, 
будут следующими.
</p>
<p>
Хост отправляет токен Setup, говорящий функции, что следующий пакет 
будет пакет Setup. Поле адреса будет содержать адрес устройства, от 
которого главный компьютер просит дескриптор. Номер конечной точки 
должен быть 0, что указывает канал по умолчанию (default pipe). Затем 
хост отправит пакет DATA0. Он будет содержать 8 байт полезной нагрузки, 
которая будет являться запросом <a href="http://microsin.ru/content/view/1108/44#GetDescriptor" target="_self">Device Descriptor Request</a>,
 описанным в Главе 9 спецификации USB. Функция USB подтверждает пакет 
setup, что он был прочитан корректно, без ошибок. Если пакет принят с 
ошибкой, устройство просто игнорирует этот пакет. Хост должен отправить 
пакет позже заново, после короткой задержки.
</p>
<div align="center">
<table style="border-width: 1px; width: 90%" border="1" cellpadding="0">
	<tbody>
		<tr>
			<td width="20%"><br>
			1. Токен Setup</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td bgcolor="#999999" width="9%">ADDR</td>
			<td bgcolor="#999999" width="9%">ENDP</td>
			<td bgcolor="#999999" width="9%">CRC5</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td width="30%">Адрес и номер конечной точки</td>
		</tr>
		<tr>
			<td colspan="8"></td>
		</tr>
		<tr>
			<td width="20%">2. Пакет Data0</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td colspan="2" bgcolor="#999999" width="17%">Data0</td>
			<td bgcolor="#999999" width="9%">CRC16</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td width="30%">Device Descriptor Request</td>
		</tr>
		<tr>
			<td colspan="8"></td>
		</tr>
		<tr>
			<td width="20%">3. Ack Handshake</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td colspan="3" width="26%"></td>
			<td width="30%">Устройство подтверждает Setup Packet</td>
		</tr>
	</tbody>
</table>
</div>
<p>
Три вышеуказанных пакета представляют из себя первую транзакцию USB. 
Теперь устройство USB будет декодировать 8 принятых байт, и определять 
по ним, что это device descriptor request (запрос на дескриптор 
устройства). После этого устройство попытается отправить <a href="http://microsin.ru/content/view/1108/44#DeviceDescriptors">Device Descriptor</a>, что произойдет в следующей транзакции USB.
</p>
<div align="center">
<table style="border-width: 1px; width: 90%" border="1" cellpadding="0">
	<tbody>
		<tr>
			<td width="20%"><br>
			1. Токен In</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td bgcolor="#999999" width="9%">ADDR</td>
			<td bgcolor="#999999" width="9%">ENDP</td>
			<td bgcolor="#999999" width="9%">CRC5</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td width="30%">Адрес и номер конечной точки</td>
		</tr>
		<tr>
			<td colspan="8"></td>
		</tr>
		<tr>
			<td width="20%">2. Пакет Data1</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td colspan="2" bgcolor="#999999" width="17%">Data1</td>
			<td bgcolor="#999999" width="9%">CRC16</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td width="30%">Первые 8 байт дескриптора устройства</td>
		</tr>
		<tr>
			<td colspan="8"></td>
		</tr>
		<tr>
			<td width="20%">3. Ack Handshake</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td colspan="3" width="26%"></td>
			<td width="30%">Хост подтверждает пакет</td>
		</tr>
	</tbody>
</table>
</div>
<div align="center">
<table style="border-width: 1px; width: 90%" border="1" cellpadding="0">
	<tbody>
		<tr>
			<td width="20%">1. Токен In</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td bgcolor="#999999" width="9%">ADDR</td>
			<td bgcolor="#999999" width="9%">ENDP</td>
			<td bgcolor="#999999" width="9%">CRC5</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td width="30%">Адрес и номер конечной точки</td>
		</tr>
		<tr>
			<td colspan="8"></td>
		</tr>
		<tr>
			<td width="20%">2. Пакет Data0</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td colspan="2" bgcolor="#999999" width="17%">Data0</td>
			<td bgcolor="#999999" width="9%">CRC16</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td width="30%">Последние 4 байта + Padding</td>
		</tr>
		<tr>
			<td colspan="8"></td>
		</tr>
		<tr>
			<td width="20%">3. Ack Handshake</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td colspan="3" width="26%"></td>
			<td width="30%">Хост подтверждает пакет</td>
		</tr>
	</tbody>
</table>
</div>
<p>
В этом случае мы подразумеваем, что максимальный размер полезной 
нагрузки 8 байт. Хост отправляет токен IN, чем говорит устройству, что 
он может теперь отправить данные для этой конечной точки. Поскольку 
максимальный размер пакета 8 байт, мы должны для отправки разделить 12 
байт дескриптора устройства на кусочки. Каждый кусочек должен быть 
размером по 8 байт, за исключением последней транзакции. Хост 
подтверждает каждый пакет, который мы посылаем ему.
</p>
<p>
Как только дескриптор устройства отправлен, начинается транзакция 
статуса. Если транзакции были успешны, хост отправляет пакет нулевой 
длины, показывающий, что полная транзакция была успешна. Функция 
отвечает на это пакетом нулевой длины, индицирующим её состояние 
(status).
</p>
<div align="center">
<table style="border-width: 1px; width: 90%" border="1" cellpadding="0">
	<tbody>
		<tr>
			<td width="20%"><br>
			1. Токен Out</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td bgcolor="#999999" width="9%">ADDR</td>
			<td bgcolor="#999999" width="9%">ENDP</td>
			<td bgcolor="#999999" width="9%">CRC5</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td width="30%">Адрес и номер конечной точки</td>
		</tr>
		<tr>
			<td colspan="8"></td>
		</tr>
		<tr>
			<td width="20%">2. Пакет Data1</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td colspan="2" bgcolor="#999999" width="17%">Data1</td>
			<td bgcolor="#999999" width="9%">CRC16</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td width="30%">Пакет нулевой длины</td>
		</tr>
		<tr>
			<td colspan="8"></td>
		</tr>
		<tr>
			<td width="20%">3. Ack Handshake</td>
			<td bgcolor="#999999" width="9%">Sync</td>
			<td bgcolor="#999999" width="7%">PID</td>
			<td bgcolor="#999999" width="9%">EOP</td>
			<td colspan="3" width="26%"></td>
			<td width="30%">Устройство подтверждает всю транзакцию целиком</td>
		</tr>
	</tbody>
</table>
</div>
<p>
<span style="color: #339966"><b>Передачи Interrupt</b></span><a name="Interrupt" title="Interrupt"></a>
</p>
<p>
Любой, кто имел дело с запросами на прерывание у микроконтроллеров, 
знает, что прерывания генерируются устройством (в микроконтроллере). 
Однако под управлением USB, если устройство требует внимания хоста, оно 
должно ждать, пока хост его не опросит, чтобы понять, что устройство 
нуждается в срочном обмене данными! Передачи Interrupt имеют следующие 
особенности:
</p>
<ul type="square">
	<li>Гарантированная латентность (latency)</li>
	<li>Однонаправленный поток канала</li>
	<li>Определение ошибок и последующая повторная попытка передачи.</li>
</ul>
<p>
Передачи Interrupt обычно непериодические, когда USB устройство 
"инициирует" связь, требующую ограниченного времени ожидания. Запрос на 
«прерывание» ставится устройством USB в очередь, пока компьютер не 
опросит устройство USB с целью получения данных.
</p>
<p>
Максимальная полезная нагрузка для low-speed устройств - 8 байт. <br>
Максимальная полезная нагрузка для full-speed устройств - 64 байта. <br>
Максимальная полезная нагрузка для high-speed устройств - 1024 байта.
</p>
<div align="center">
<table style="width: 80%" border="0" cellpadding="0">
	<tbody>
		<tr>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-transint.gif" alt="USBinNutShell-transint.gif" title="USBinNutShell-transint.gif" style="width: 366px; height: 322px" align="bottom" height="322" width="366"></td>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-transkey.gif" alt="USBinNutShell-transkey.gif" title="USBinNutShell-transkey.gif" style="width: 125px; height: 27px" align="bottom" height="27" width="125"></td>
		</tr>
	</tbody>
</table>
</div>
<p>
На диаграмме показан формат транзакций Interrupt IN и Interrupt OUT.
</p>
<p>
<b>Interrupt IN</b>: хост периодически опрашивает конечную точку interrupt. Скорость опроса указана в описателе конечной точки (<a href="http://microsin.ru/content/view/1108/44#EndpointDescriptors">endpoint descriptor</a>),
 который мы рассмотрим позже. Каждый опрос сопровождается отправкой 
хостом токена IN. Если токен IN испорчен, функция игнорирует пакет, и 
продолжает мониторинг шины в ожидании новых токенов.
</p>
<p>
Если interrupt поставлено в очередь устройством USB, функция отправит 
пакет data, содержащий данные, соответствующие interrupt при приеме 
токена IN. После успешного приема хостом, хост возвратит ACK. Однако, 
если данные были испорчены, хост не вернет status. Условие прерывания не
 присутствовало, когда главный компьютер опросил оконечную точку 
прерывания токеном IN, но функция ответила о своем состоянии NAK. Если 
на этой конечной точке произошла ошибка, то в ответ на токен IN будет 
отправлен STALL.
</p>
<p>
<b>Interrupt OUT</b>: когда хост хочет отправить устройству данные 
interrupt, он выдает токен OUT, за которым идет пакет data, содержащий 
данные interrupt. Если любая часть - токен OUT или пакет data ошибочны, 
функция игнорирует пакет. Если буфер конечной точки функции был пуст, и 
функция вывела данные в буфер конечной точки, она выдает ACK, информируя
 хост об успешно принятых данных. Если буфер конечной точки не пуст (еще
 идет обработка предыдущего пакета), то функция выдает NAK. Однако, если
 ошибка произошла с конечной точкой и ее бит останова был установлен, то
 функция выдает STALL.
</p>
<p>
<span style="color: #339966"><b>Изохронные передачи (Isochronous Transfers)</b></span><a name="Isochronous" title="Isochronous"></a>
</p>
<p>
Изохронные передачи происходят периодически и продолжительное время. Они
 обычно содержат информацию, привязанную ко времени (чувствительную к 
времени доставки), например аудио или видео потоки. Если произойдет 
задержка или повторная передача данных в аудио потоке, то Вы должны в 
результате получить искаженный звук. Дополнительная неприятность – может
 пропасть синхронизация звука. Однако выпадение пакетов или фреймов 
могут случаться постоянно снова и снова, и это будет менее заметно для 
слушателя. Изохронные передачи обеспечивают:
</p>
<ul type="square">
	<li>Гарантированное выделение полосы пропускания шины USB.</li>
	<li>Ограниченную латентность.</li>
	<li>Однонаправленный поток канала.</li>
	<li>Детектирование ошибок с помощью CRC, но без гарантии доставки (нет повторов при ошибках).</li>
	<li>Работают только на скоростях Full speed и high speed.</li>
	<li>Нет переключения данных.</li>
</ul>
<p>
Для изохронной конечной точки максимальный размер полезной нагрузки по данным указывается в дескрипторе конечной точки (<a href="http://microsin.ru/content/view/1108/44#EndpointDescriptors">endpoint descriptor</a>).
 Этот размер может быть максимум до 1023 байт для full speed и до 1024 
байт для high speed. Поскольку максимальный размер полезной нагрузки 
влияет на требование к шине по полосе пропускания, следует внимательно 
отнестись к его выбору. Если Вы используете большую полезную нагрузку, 
то может оказаться хорошим выбором задать серию альтернативных 
интерфейсов (<a href="http://microsin.ru/content/view/1108/44#AlternateSetting">alternative interfaces</a>)
 с различными изохронными размерами полезной нагрузки. Если во время 
энумерации хост не может предоставить Вашей изохронной конечной точке 
привилегированную полосу из-за ограничений полосы пропускания, то у него
 еще будут другие варианты полосы вместо того, чтобы потерпеть неудачу 
полностью. Данные, посылаемые через изохронную конечную точку, могут 
быть меньше предварительно оговоренного размера, и могут измениться по 
длине от транзакции к транзакции.
</p>
<div align="center">
<table style="width: 80%" border="0" cellpadding="0">
	<tbody>
		<tr>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-transiso.gif" alt="USBinNutShell-transiso.gif" title="USBinNutShell-transiso.gif" style="border: 0px none #000000; width: 213px; height: 131px" align="bottom" border="0" height="131" width="213"></td>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-transkey.gif" alt="USBinNutShell-transkey.gif" title="USBinNutShell-transkey.gif" style="border: 0px none #000000; width: 125px; height: 27px" align="bottom" border="0" height="27" width="125"></td>
		</tr>
	</tbody>
</table>
</div>
<p>
На диаграмме показан формат изохронных транзакций IN и OUT. Изохронные 
транзакции не имеют стадии установления связи (рукопожатия, handshaking 
stage) и не могут сообщать об ошибках или событиях STALL/HALT.
</p>
<p>
<span style="color: #339966"><b>Передачи Bulk</b></span><a name="Bulk" title="Bulk"></a>
</p>
<p>
Bulk-передачи можно использовать для большого объема быстропередаваемых 
данных. В качестве примера можно привести задание по выводу на печать, 
посланное в принтер, или изображение, сгенерированное от сканера. 
Bulk-передачи предоставляют коррекцию ошибок полезной нагрузки с помощью
 поля CRC16 и механизмы детектирования ошибок и повторной передачи, 
гарантирующие отсутствие ошибок в передаваемых или принятых данных. <br>
Bulk-передачи будут использовать остаточную полосу пропускания шины 
после того, как все другие транзакции были распределены. Если шина 
занята данными isochronous и/или interrupt, то данные bulk могут 
прередаваться через шину медленно. Следовательно, передачи Bulk должны 
использоваться только для интенсивных коммуникаций с негарантированным 
временем доставки. Особенности передачи Bulk:
</p>
<ul type="square">
	<li>Используются для передачи большого объема данных на высокой скорости за короткое время.</li>
	<li>Детектирование ошибок с помощью CRC, с гарантией доставки.</li>
	<li>Не гарантируется полоса пропускания или минимальная задержка (минимальная латентность).</li>
	<li>Однонаправленный поток данных канала.</li>
	<li>Работает только на скоростях Full speed и high speed.</li>
</ul>
<p>
Bulk-передачи поддерживаются только full speed и high speed 
устройствами. Для конечных точек full speed максимальный размер пакета 
bulk бывает 8, 16, 32 или 64 байта длиной. Для конечных точек high 
speed, максимальный размер пакета может до 512 байт длиной. Если 
полезная нагрузка данных меньше максимального размера пакета, она не 
должна быть дополнена нулями. Bulk-передачу считают законченной, когда 
она передала точное количество запрошенных данных, передала пакет 
меньше, чем максимальный размер оконечной точки, передала пакет нулевой 
длины.
</p>
<div align="center">
<table style="width: 80%" border="0" cellpadding="0">
	<tbody>
		<tr>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-contdata.gif" alt="USBinNutShell-contdata.gif" title="USBinNutShell-contdata.gif" style="border: 0px none #000000; width: 315px; height: 322px" align="bottom" border="0" height="322" width="315"></td>
			<td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/USBinNutShell-transkey.gif" alt="USBinNutShell-transkey.gif" title="USBinNutShell-transkey.gif" style="border: 0px none #000000; width: 125px; height: 27px" align="bottom" border="0" height="27" width="125"></td>
		</tr>
	</tbody>
</table>
</div>
<p>
На диаграмме показан формат транзакций bulk IN и bulk OUT.
</p>
<p>
<b>Bulk IN</b>: когда хост готов принять данные bulk, он выдает токен 
IN. Если функция принимает токен IN с ошибкой, она игнорирует пакет. 
Если токен принят корректно, функция может ответить либо пакетом DATA 
(содержащим отправляемые данные bulk), либо пакетом stall, 
(показывающим, что конечная точка имеет ошибку), либо пакетом NAK 
(показывающим, что конечная точка в работе, но у нее пока нет данных для
 отправки).
</p>
<p>
<b>Bulk OUT</b>: когда хост хочет отправить функции пакет bulk data, он 
выдает токен OUT, за которым идет data пакет, содержащий данные bulk. 
Если любая часть токена OUT или пакета data повреждена, функция 
игнорирует пакет. Если буфер конечной точки функции пуст, функция 
вдвигает данные в буфер конечной точки и выдает ACK, информируя хост об 
успешно принятых данных. Если буфер конечной точки функции не пуст по 
причине обработки предыдущего пакета, функция возвращает NAK. Однако 
если конечная точка в состоянии ошибки, и её halt-бит установлен, 
функция возвращает STALL.
</p>
<p>
<span style="color: #339966"><b><b><b><b>Управление полосой пропускания </b></b></b></b></span>
</p>
<p>
Хост отвечает за управление полосой пропускания шины. Это происходит при
 энумерации, и конфигурировании изохронных конечных точек и конечных 
точек interrupt через операции на шине. Спецификация накладывает 
ограничения на шину, которые разрешают выделение не более 90% всех 
фреймов для периодических передач (Interrupt или Isochronous) на шине 
full speed. На шине high speed это ограничение уменьшено - не более 80% 
микрофреймов можно выделить для периодических передач.
</p>
<p>
Таким образом, очевидно - если у Вас есть шина, очень нагруженная 
периодическими передачами, то оставшиеся 10% оставлены для передач 
управления (control transfers), и как только они будут распределены 
(обработаны), передачи bulk получат оставшуюся часть полосы.
</p>
<p>
[<a href="http://microsin.net/programming/arm-working-with-usb/usb-in-a-nutshell-part2.html" target="_self"><b>Продолжение статьи...</b></a>]
</p>
			</td>
		</tr>
					<tr>
				<td colspan="2" class="modifydate" align="left">
					Последнее обновление ( 29.11.2014 )
				</td>
			</tr>
					</tbody></table>

		<span class="article_seperator">&nbsp;</span>

		<br>


<script type="text/javascript">
var xajaxRequestUri='',xajaxDebug=false,xajaxStatusMessages=false,xajaxWaitCursor=true,xajaxDefinedGet=0,xajaxDefinedPost=1;
function jc_setup(){xajaxRequestUri='http://microsin.ru/index2.php?option=com_jcomments&amp;Itemid=44&amp;no_html=1';xajaxDebug=false,xajaxStatusMessages=false,xajaxWaitCursor=true,xajaxDefinedGet=0,xajaxDefinedPost=1;
xajax.loadingFunction=function(){xajax.$('jc_busy').style.display='block';};xajax.doneLoadingFunction=function(){xajax.$('jc_busy').style.display='none';}}
</script>
<script src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/xajax_002.js" type="text/javascript"></script>


<script src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/jcomments.js" type="text/javascript"></script>

<div id="jc">
<div id="comments">
	
	
		<h4>Комментарии&nbsp;<a href="http://microsin.ru/index2.php?option=com_jcomments&amp;task=rss&amp;object_id=1107&amp;object_group=com_content&amp;no_html=1" title="RSS лента комментариев этой записи." target="_blank"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/jc_rss.gif" alt="" border="0"></a><span class="refresh" title="Обновить список комментариев" onclick="jc_showPage(1107,'com_content',0,0);">&nbsp;</span></h4>
		
		<center> <div id="nav-top"><span class="activepage"><b>1</b></span>

<span onclick="jc_showPage(1107, 'com_content', 2);" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">2</span>
<span onclick="jc_showPage(1107, 'com_content', 3);" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">3</span></div> </center>
		<ol id="comments-list" class="commentlist">
			
					<li class="odd" id="comment-2581"><span class="quote" onclick="javascript:jc_quoteComment(2581);" title="Цитировать"></span>  <a class="comment-anchor" href="http://microsin.ru/content/view/1107/44/#comment-2581" id="comment-2581">#22</a> <span class="comment-author">Hetman</span>  <br> <span class="comment-date">2014-11-29</span><span class="comment-time">19:25:20</span>  <span class="comment-body" id="comment-body-2581">Бедный, еще и какой… <br>Прочтите очень внимательно, что написано в этом месте:<br> Стадия status stage также имеет два различных сценария, в зависимости от направления передачи данных.<br><br>Сценарий IN: если хост отправил токен…<br><br>И посмотрите какая картинка там нарисована. Надо поменять местами ее и следующую…<br><br>microsin: благодарю, поправил.</span>  </li>
				
					<li class="even" id="comment-2580"><span class="quote" onclick="javascript:jc_quoteComment(2580);" title="Цитировать"></span>  <a class="comment-anchor" href="http://microsin.ru/content/view/1107/44/#comment-2580" id="comment-2580">#21</a> <span class="comment-author">Hetman</span>  <br> <span class="comment-date">2014-11-29</span><span class="comment-time">18:42:05</span>  <span class="comment-body" id="comment-body-2580">Ошибку
 подтверждаю. Странно, что вы ее не видите. У меня вообще талант 
находить ошибки. Я в книгах уважаемых авторов находил косяки не раз, и 
даже заставил Microchip переделать даташит на целую серию контроллеров. 
Но при этом остаюсь бедным преподом… какая жалость… <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/smile.gif" alt="" border="0"><br><br>microsin: не верю что-то, что Вы "бедный" препод. Скорее всего небедный =). Или такое положение Вас чем-то устраивает.</span>  </li>
				
					<li class="odd" id="comment-2579"><span class="quote" onclick="javascript:jc_quoteComment(2579);" title="Цитировать"></span>  <a class="comment-anchor" href="http://microsin.ru/content/view/1107/44/#comment-2579" id="comment-2579">#20</a> <span class="comment-author">Hetman</span>  <br> <span class="comment-date">2014-11-29</span><span class="comment-time">17:26:06</span>  <span class="comment-body" id="comment-body-2579">Нашел опечатку. Там, где описывается передача Control, cтадия status stage - рисунки сценариев IN и OUT перепутаны местами.<br>А в общем, замечательный вдумчивый обработанный перевод. Читается запоем как увлекательный роман. <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/smile.gif" alt="" border="0"> <br>Спасибо
 автору. Теперь USB не боюсь, хотя действительно "навороченный" 
протокол. Хотя принципы остались те же. Знакомые слова (handshacking) 
еще с протоколов ISA. Такой же принцип передачи адреса хостом как и в 
I2C и во всех последовательны<span style="font-size:0px;padding:0;margin:0;"> </span>х
 протоколах. Знакомый acknowlege (ACK) при успешной передаче. 
Классические арбитры (PID). Но все эти режимы, типы передач, точки, 
безусловно, напрягают. <br>Еще раз спасибо автору. <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/smile.gif" alt="" border="0"><br><br>microsin: честно говоря, никакой опечатки не заметил. Уверены?</span>  </li>
				
					<li class="even" id="comment-2549"><span class="quote" onclick="javascript:jc_quoteComment(2549);" title="Цитировать"></span>  <a class="comment-anchor" href="http://microsin.ru/content/view/1107/44/#comment-2549" id="comment-2549">#19</a> <span class="comment-author">WitFed</span>  <br> <span class="comment-date">2014-09-02</span><span class="comment-time">12:15:49</span>  <span class="comment-body" id="comment-body-2549">После фразы: "После этого устройство попытается отправить Device Descriptor, что произойдет в следующей транзакции USB."<br>Здесь неточность, дескриптор устройства занимает не 12 байт, а 18 (12 в HEX), требуя 3 транзакций: 8, 8 и 2 байта.</span>  </li>
				
					<li class="odd" id="comment-2542"><span class="quote" onclick="javascript:jc_quoteComment(2542);" title="Цитировать"></span>  <a class="comment-anchor" href="http://microsin.ru/content/view/1107/44/#comment-2542" id="comment-2542">#18</a> <span class="comment-author">WitFed</span>  <br> <span class="comment-date">2014-08-14</span><span class="comment-time">11:21:41</span>  <span class="comment-body" id="comment-body-2542">Всё прекрасно вылизано по отношению к "монстроидальным<span style="font-size:0px;padding:0;margin:0;"> </span>" оригиналам, спасибо!<br>Кусок
 "и включает includes a setup packet", вероятно, нужно освободить от 
"includes a". А заявленный механизм посыла сообщений об описках по 
Shift-Enter почему-то не работает здесь, выделение даже делается с 
трудом.</span>  </li>
				
					<li class="even" id="comment-2513"><span class="quote" onclick="javascript:jc_quoteComment(2513);" title="Цитировать"></span>  <a class="comment-anchor" href="http://microsin.ru/content/view/1107/44/#comment-2513" id="comment-2513">#17</a> <span class="comment-author">RAN</span>  <br> <span class="comment-date">2014-04-12</span><span class="comment-time">16:29:59</span>  <span class="comment-body" id="comment-body-2513">Microsin, респект за перевод!</span>  </li>
				
					<li class="odd" id="comment-2483"><span class="quote" onclick="javascript:jc_quoteComment(2483);" title="Цитировать"></span>  <a class="comment-anchor" href="http://microsin.ru/content/view/1107/44/#comment-2483" id="comment-2483">#16</a> <span class="comment-author">Игорь</span>  <br> <span class="comment-date">2014-01-15</span><span class="comment-time">10:47:01</span>  <span class="comment-body" id="comment-body-2483">Спасибо, первый шаг сделал. Но я не могу скачать программу под Windows, ссылки не работающие.<br><br>microsin:
 благодарю. Но про какую программу Вы говорите, какие ссылки не 
работающие?.. Напишите мне пожалуйста на email (см. раздел Контакты).</span>  </li>
				
					<li class="even" id="comment-2430"><span class="quote" onclick="javascript:jc_quoteComment(2430);" title="Цитировать"></span>  <a class="comment-anchor" href="http://microsin.ru/content/view/1107/44/#comment-2430" id="comment-2430">#15</a> <span class="comment-author">ohmjke</span>  <br> <span class="comment-date">2013-09-17</span><span class="comment-time">23:32:57</span>  <span class="comment-body" id="comment-body-2430">Не
 понимаю, зачем вообще стадия status stage? Ведь всё равно во время 
стадии data stage каждый пакет data подтверждается пакетом ACK.</span>  </li>
				
					<li class="odd" id="comment-2411"><span class="quote" onclick="javascript:jc_quoteComment(2411);" title="Цитировать"></span>  <a class="comment-anchor" href="http://microsin.ru/content/view/1107/44/#comment-2411" id="comment-2411">#14</a> <span class="comment-author">dtvims</span>  <br> <span class="comment-date">2013-08-09</span><span class="comment-time">07:39:12</span>  <span class="comment-body" id="comment-body-2411">Нашлась опечаточка:<br>На низкоскоростных<span style="font-size:0px;padding:0;margin:0;"> </span> (low speed) и полноскоростных<span style="font-size:0px;padding:0;margin:0;"> </span> (full speed) устройствах дифференциальна<span style="font-size:0px;padding:0;margin:0;"> </span>я
 ‘1’ передается путем повышения уровня D+ свыше +2.8V резистором 15КОм, 
подключенным к +3.6V и D- ниже +0.3V резистором 1.5КОм, подключенным к 
земле. Дифференциальны<span style="font-size:0px;padding:0;margin:0;"> </span>й ‘0’ передается тем же способом, только уровни меняются на противоположные<span style="font-size:0px;padding:0;margin:0;"> </span> - D- свыше 2.8V и D+ ниже 0.3V.<br><br>Что противоречит действительност<span style="font-size:0px;padding:0;margin:0;"> </span>и. 15КОм подключаются к земле, а 1.5КОм к плюсу. Сравните с оригиналом:<br><br>On
 low and full speed devices, a differential ‘1’ is transmitted by 
pulling D+ over 2.8V with a 15K ohm resistor pulled to ground and D- 
under 0.3V with a 1.5K ohm resistor pulled to 3.6V. A differential ‘0’ 
on the other hand is a D- greater than 2.8V and a D+ less than 0.3V with
 the same appropriate pull down/up resistors.<br><br>microsin: если и 
опечатка, то скорее всего в оригинале. Скажите пожалуйста, как можно 
поднять уровень D+ (pulling D+ over 2.8V), если подключить резистор 15 
кОм к земле (with a 15K ohm resistor pulled to ground)?.. Звучит как 
бред. То же самое можно сказать и про сигнал D-, потому что невозможно 
опустить напряжение ниже 0.3V (D- under 0.3V) резистором 1.5 кОм, 
подключенным к 3.6V (1.5K ohm resistor pulled to 3.6V).</span>  </li>
				
					<li class="even" id="comment-2279"><span class="quote" onclick="javascript:jc_quoteComment(2279);" title="Цитировать"></span>  <a class="comment-anchor" href="http://microsin.ru/content/view/1107/44/#comment-2279" id="comment-2279">#13</a> <span class="comment-author">Вячеслав</span>  <br> <span class="comment-date">2013-03-01</span><span class="comment-time">04:38:07</span>  <span class="comment-body" id="comment-body-2279">Спасибо за хороший материал, как жаль что не нашел этого раньше!</span>  </li>
				
		</ol>
		<center> <div id="nav-bottom"> <span class="activepage"><b>1</b></span>

<span onclick="jc_showPage(1107, 'com_content', 2);" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">2</span>
<span onclick="jc_showPage(1107, 'com_content', 3);" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">3</span> </div> </center>
		<div id="comments-rss"><a href="http://microsin.ru/index2.php?option=com_jcomments&amp;task=rss&amp;object_id=1107&amp;object_group=com_content&amp;no_html=1" target="_blank">RSS лента комментариев этой записи.</a></div>
	
</div>
<div id="jc_busy"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/jc_busy.gif" alt=""></div>

        <br>
	<h4>Добавить комментарий</h4>
	<script language="JavaScript" type="text/javascript">
		
	</script>
	<a id="addcomments" href="#addcomments"></a>
	<form id="comments-form" name="comments-form" action="javascript:void(null);">
	
	
	<p>
		<input id="comments-form-name" name="name" maxlength="20" size="22" tabindex="1" onfocus="javascript:this.className='selected';" onblur="javascript:this.className='';" type="text">
		<label for="comments-form-name">Имя (обязательное)</label>
	</p>
	
	
	<p> <input id="comments-form-homepage" name="homepage" size="22" tabindex="3" onfocus="javascript:this.className='selected';" onblur="javascript:this.className='';" type="text"> <label for="comments-form-homepage"> Сайт </label> </p>
	<p>
	<img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/laugh.gif" onclick="jc_smile(':D');" alt=":D"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/lol.gif" onclick="jc_smile(':lol:');" alt=":lol:"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/smile.gif" onclick="jc_smile(':-)');" alt=":-)"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/wink.gif" onclick="jc_smile(';-)');" alt=";-)"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/cool.gif" onclick="jc_smile('8)');" alt="8)"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/normal.gif" onclick="jc_smile(':-|');" alt=":-|"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/whistling.gif" onclick="jc_smile(':-*');" alt=":-*"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/redface.gif" onclick="jc_smile(':oops:');" alt=":oops:"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/sad.gif" onclick="jc_smile(':sad:');" alt=":sad:"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/cry.gif" onclick="jc_smile(':cry:');" alt=":cry:"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/surprised.gif" onclick="jc_smile(':o');" alt=":o"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/confused.gif" onclick="jc_smile(':-?');" alt=":-?"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/sick.gif" onclick="jc_smile(':-x');" alt=":-x"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/shocked.gif" onclick="jc_smile(':eek:');" alt=":eek:"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/sleeping.gif" onclick="jc_smile(':zzz');" alt=":zzz"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/tongue.gif" onclick="jc_smile(':P');" alt=":P"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/rolleyes.gif" onclick="jc_smile(':roll:');" alt=":roll:"><img class="smile" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/unsure.gif" onclick="jc_smile(':sigh:');" alt=":sigh:"><br>
	
		<textarea id="comments-form-comment" onchange="jc_changed(1000);jc_storeCaret(this);" onkeyup="jc_changed(1000);" onselect="jc_storeCaret(this);" onclick="jc_storeCaret(this);" name="comment" cols="65" rows="5" tabindex="4" onfocus="javascript:this.className='selected';" onblur="javascript:this.className='';" onkeypress="return jc_keypress(event);"></textarea>
		
			<br><label for="comments-form-comment">Осталось: &nbsp;<span id="comments-form-comment-length">1000</span>&nbsp; символов</label>
		
		
	</p>
	<p>
	
	<img class="captcha" id="comments-form-captcha-image" name="captcha-image" src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/index2.jpg" alt="Защитный код" height="60" width="120"><br> <span class="captcha" onclick="xajax.$('comments-form-captcha-image').src='http://microsin.ru/index2.php?option=com_jcomments&amp;task=captcha&amp;no_html=1&amp;ac=' + new String(Math.random())">Обновить</span><br> <input class="captcha" id="comments-form-captcha-refid" name="captcha-refid" size="5" tabindex="6" onfocus="javascript:this.className='captcha-selected';" onblur="javascript:this.className='captcha';" type="text"><br>
	<input class="button" name="submit" value="Отправить (Ctrl+Enter)" tabindex="7" onclick="jc_sendComment();" type="button">
	</p>
	<input name="object_id" value="1107" type="hidden">
	<input name="object_group" value="com_content" type="hidden">
	</form>

<div id="comments-footer" align="center"><a href="http://www.joomlatune.ru/" title="JComments" target="_blank">JComments</a></div>
</div>
<script type="text/javascript">
function jc_addEvent(o,e,f){if(o.addEventListener){o.addEventListener(e,f,false);return true;}else if(o.attachEvent){var r=o.attachEvent("on"+e,f);return r;}else{return false;}}
function jc_onload(){if(arguments.callee.done) return;arguments.callee.done=true;if(_timer){clearInterval(_timer);_timer=null;}
if(xajaxLoaded){var l=document.location.href,i=l.lastIndexOf('#comment-');
if(i!=0){var c=l.substring(i+9,l.length);if(!isNaN(c)){jc_showComment(c);}}

}else{window.setTimeout(jc_onload,5000);}}
if(document.addEventListener){document.addEventListener("DOMContentLoaded",jc_onload,false);}
/*@cc_on @*/
/*@if (@_win32)
document.write("<script id=__ie_onload defer src=javascript:void(0)><\/script>");
var script=document.getElementById("__ie_onload");script.onreadystatechange=function(){if(this.readyState=="complete"){jc_onload();}};
/*@end @*/
if(/WebKit/i.test(navigator.userAgent)){var _timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){jc_onload();}},10);}
jc_addEvent(window,'load',jc_onload);
</script>			<table style="margin-top: 25px;" align="center">
			<tbody><tr>
									<th class="pagenav_prev">
						<a href="http://microsin.ru/content/view/1108/44/">
							&lt; Пред.</a>
					</th>
										<td width="50">&nbsp;

					</td>
										<th class="pagenav_next">
						<a href="http://microsin.ru/content/view/1104/44/">
							След. &gt;</a>
					</th>
								</tr>
			</tbody></table>
						<div class="back_button">
				<a href="javascript:history.go(-1)">
					Назад</a>
			</div>
			              <!-- Bottom Modules -->
              <p></p>
                            </td>
              <!-- RIGHT Modules -->
                          </tr>
          </tbody></table>
          </td>
        </tr>
      </tbody></table>
      </td>
      <td background="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20(%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE)_files/shad_right.gif" valign="top">
      <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/shad_top_right.gif" border="0" height="17" width="11"></td>
    </tr>
    <tr>
      <td><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/shad_bottom_left.gif" border="0" height="19" width="11"></td>
      <td background="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20(%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE)_files/shad_bottom.gif" width="100%">
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tbody><tr>
          <td>
          <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/shad_bottom_inner_left.gif" border="0" height="19" width="19"></td>
          <td align="left"><a href="#top"><img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/top_of_page.gif" alt="Top of Page" border="0" vspace="5"></a></td>
          <td align="right" width="100%"><!--закомментировано для устранения ошибки "File does not exist:
           /home/microsig/public_html/images/poweredbyLong.gif"<img src="images/poweredbyLong.gif" width="169" height="8" vspace="5" border="0" alt="Powered by Mambo Open Source">--></td>  
          <td>
          <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/shad_bottom_inner_right.gif" border="0" height="19" width="19"></td>
        </tr>
      </tbody></table>
      </td>
      <td>
      <img src="microsin%20-%20USB%20in%20a%20NutShell%20-%20%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%BF%D0%BE%20%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%83%20USB%20%28%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE%29_files/shad_bottom_right.gif" border="0" height="19" width="11"></td>
    </tr>
  </tbody></table>
  <table align="center" border="0" cellpadding="3" cellspacing="0" width="780">
    <tbody><tr>
      <td align="center">
        &nbsp;        <div align="center">
	microsin © 2015 
</div>
<!--div align="center">
	</div-->      </td>
    </tr>
  </tbody></table>

<div style="position: absolute; display: none; width: 375px; height: 380px; top: 50px; left: 50px; z-index: 2;" id="MistWindow"></div></body></html>
<!-- 1445329071 -->